import{u as D,r as u,j as t,i as L}from"./vendor-klSkc7do.js";import{g as pe,m as Ee,l as q,i as De,a as R,y as Fe,b as je,e as te,c as G,f as be,d as ve,h as xe,j as we}from"./index-C3Afrm5l.js";const Se=[{code:"en",name:"English (United States)"},{code:"en-GB",name:"English (United Kingdom)"},{code:"ja",name:"日本語"},{code:"de",name:"Deutsch"},{code:"fr",name:"Français (France)"},{code:"fr-CA",name:"Français (Canada)"},{code:"es",name:"Español (España)"},{code:"it",name:"Italiano"},{code:"ko",name:"한국어"},{code:"zh-Hans",name:"简体中文"},{code:"zh-Hant",name:"繁体中文"}];function ke({showModal:e,limit:s,limitRef:n}){const{t:a}=D(),[r,c]=u.useState(pe),o=async i=>{await Fe(),await L.changeLanguage(i.target.value,g=>{g&&g.some(p=>!p.message.includes("Unknown variable dynamic import"))&&(console.log(g),e({message:a("options.network"),buttons:[{message:t.jsx(oe,{}),autoFocus:!0}]}))})},d=i=>{const g=i.target.value;je(g)&&(c(g),R("mode",g),document.body.classList.replace(`mode-${r}`,`mode-${g}`))},A=i=>{const g=i.target.value;(g==="true"||g==="false")&&R("corpus-longURL",g)},C=i=>{const g=i.target.value;(g==="true"||g==="false")&&R("corpus-richText",g)};return t.jsx("div",{className:"options",children:t.jsxs("div",{className:"options-grid",children:[t.jsx("label",{htmlFor:"language",children:a("options.language")}),t.jsx("select",{name:"language",id:"language",onChange:o,defaultValue:L.language,autoFocus:!0,children:Se.map(i=>t.jsx("option",{value:i.code,lang:i.code,children:i.name},i.code))}),t.jsx("label",{htmlFor:"mode",children:a("options.mode")}),t.jsx("select",{name:"mode",id:"mode",onChange:d,defaultValue:r,children:Ee.map(i=>t.jsx("option",{value:i,children:a(`options.modes.${i}`)},i))}),t.jsx("label",{htmlFor:"longURL",children:a("options.longURL")}),t.jsx("select",{name:"longURL",id:"longURL",onChange:A,defaultValue:q("corpus-longURL")??"false",children:["true","false"].map(i=>t.jsx("option",{value:i,children:a(`options.longURLSelect.${i}`)},i))}),t.jsx("label",{htmlFor:"richText",children:a("options.richText")}),t.jsx("select",{name:"richText",id:"richText",onChange:C,defaultValue:q("corpus-richText")??"true",children:["true","false"].map(i=>t.jsx("option",{value:i,children:a(`options.richTextSelect.${i}`)},i))}),t.jsx("label",{htmlFor:"limit",children:a("options.limit")}),t.jsx("input",{ref:n,type:"number",name:"limit",id:"limit",min:1,defaultValue:s})]})})}function oe(){const{t:e}=D();return e("options.close")}function ye(e){const{t:s}=D(),{showModal:n,setLimit:a}=e,r=u.useRef(null),c=()=>{if(r.current!==null){const d=r.current.valueAsNumber;De(d)&&(R("corpus-limit",d.toString()),a(d))}},o={classes:["modal-options"],message:t.jsx(ke,{...e,limitRef:r}),buttons:[{message:t.jsx(oe,{}),callback:c}],cancelCallback:c};return t.jsxs("button",{className:"header-options",onClick:()=>n(o),children:[t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",height:"1em",viewBox:"0 0 512 512",children:t.jsx("path",{d:"M495.9 166.6c3.2 8.7 .5 18.4-6.4 24.6l-43.3 39.4c1.1 8.3 1.7 16.8 1.7 25.4s-.6 17.1-1.7 25.4l43.3 39.4c6.9 6.2 9.6 15.9 6.4 24.6c-4.4 11.9-9.7 23.3-15.8 34.3l-4.7 8.1c-6.6 11-14 21.4-22.1 31.2c-5.9 7.2-15.7 9.6-24.5 6.8l-55.7-17.7c-13.4 10.3-28.2 18.9-44 25.4l-12.5 57.1c-2 9.1-9 16.3-18.2 17.8c-13.8 2.3-28 3.5-42.5 3.5s-28.7-1.2-42.5-3.5c-9.2-1.5-16.2-8.7-18.2-17.8l-12.5-57.1c-15.8-6.5-30.6-15.1-44-25.4L83.1 425.9c-8.8 2.8-18.6 .3-24.5-6.8c-8.1-9.8-15.5-20.2-22.1-31.2l-4.7-8.1c-6.1-11-11.4-22.4-15.8-34.3c-3.2-8.7-.5-18.4 6.4-24.6l43.3-39.4C64.6 273.1 64 264.6 64 256s.6-17.1 1.7-25.4L22.4 191.2c-6.9-6.2-9.6-15.9-6.4-24.6c4.4-11.9 9.7-23.3 15.8-34.3l4.7-8.1c6.6-11 14-21.4 22.1-31.2c5.9-7.2 15.7-9.6 24.5-6.8l55.7 17.7c13.4-10.3 28.2-18.9 44-25.4l12.5-57.1c2-9.1 9-16.3 18.2-17.8C227.3 1.2 241.5 0 256 0s28.7 1.2 42.5 3.5c9.2 1.5 16.2 8.7 18.2 17.8l12.5 57.1c15.8 6.5 30.6 15.1 44 25.4l55.7-17.7c8.8-2.8 18.6-.3 24.5 6.8c8.1 9.8 15.5 20.2 22.1 31.2l4.7 8.1c6.1 11 11.4 22.4 15.8 34.3zM256 336a80 80 0 1 0 0-160 80 80 0 1 0 0 160z",fill:"currentColor"})}),s("options.options")]})}const Ms=Object.freeze(Object.defineProperty({__proto__:null,default:ye},Symbol.toStringTag,{value:"Module"}));function Le(e){return new Worker("/poke-corpus/assets/searchWorkerManager-DdYTvyXX.js",{name:e?.name})}const He=["error","regex","noMatch","network","boolean.parentheses","boolean.quote","boolean.operand","boolean.empty","boolean.where"],X=["loading","processing","collecting"],Ne=["qid","ja-Hrkt","ja","en","en-GB","fr","it","de","es","es-419","ko","zh-Hans","zh-Hans-CN","zh-Hant","pt-BR","th","ru","tr","id","hi"],qe={Red:{languages:["ja-Hrkt","en","fr","it","de","es"],structured:!1,files:["data"]},Green:{languages:["ja-Hrkt"],structured:!1,files:["data"]},Blue:{languages:["ja-Hrkt","en","fr","it","de","es"],structured:!1,files:["data"]},Yellow:{languages:["ja-Hrkt","en","fr","it","de","es"],structured:!1,files:["data"]},Gold:{languages:["ja-Hrkt","en","fr","it","de","es","ko"],structured:!1,files:["data"]},Silver:{languages:["ja-Hrkt","en","fr","it","de","es","ko"],structured:!1,files:["data"]},Crystal:{languages:["ja-Hrkt","en","fr","it","de","es"],structured:!1,files:["data"]},RubySapphire:{id:"rs",languages:["qid","ja-Hrkt","en","fr","it","de","es"],structured:!0,version:{ja:"1.1",en:"1.2",fr:"1.1",it:"1.1",de:"1.1",es:"1.1"},files:["msg"],literals:{KUN:{branch:"gender",line:[12348,12349]},VERSION:{branch:"version",line:[12351,12350]},EVIL_TEAM:{branch:"version",line:[12353,12352]},GOOD_TEAM:{branch:"version",line:[12352,12353]},EVIL_LEADER:{branch:"version",line:[12355,12354]},GOOD_LEADER:{branch:"version",line:[12354,12355]},EVIL_LEGENDARY:{branch:"version",line:[12357,12356]},GOOD_LEGENDARY:{branch:"version",line:[12356,12357]},RIVAL:{branch:"gender",line:[12359,12358]}}},FireRedLeafGreen:{id:"frlg",languages:["qid","ja-Hrkt","en","fr","it","de","es"],structured:!0,version:{ja:"1.0",en:"1.1",fr:"1.0",it:"1.0",de:"1.0",es:"1.0"},files:["msg"],literals:{KUN:{branch:"gender",line:[9351,9352]}}},Emerald:{id:"e",languages:["qid","ja-Hrkt","en","fr","it","de","es"],structured:!0,version:"1.0",files:["msg"],literals:{KUN:{branch:"gender",line:[15105,15106]},VERSION:{line:15109},EVIL_TEAM:{line:15110},GOOD_TEAM:{line:15111},EVIL_LEADER:{line:15112},GOOD_LEADER:{line:15113},EVIL_LEGENDARY:{line:15114},GOOD_LEGENDARY:{line:15115},RIVAL:{branch:"gender",line:[15117,15116]}}},DiamondPearl:{id:"dp",languages:["qid","ja-Hrkt","en","en-GB","fr","it","de","es","ko"],structured:!0,files:["msg"]},Platinum:{id:"pt",languages:["qid","ja-Hrkt","en","en-GB","fr","it","de","es","ko"],structured:!0,files:["msg"]},HeartGoldSoulSilver:{id:"hgss",languages:["qid","ja-Hrkt","en","fr","it","de","es","ko"],structured:!0,files:["msg"]},BlackWhite:{id:"bw",languages:["qid","ja-Hrkt","ja","en","fr","it","de","es","ko"],structured:!0,files:["common","script"]},Black2White2:{id:"b2w2",languages:["qid","ja-Hrkt","ja","en","fr","it","de","es","ko"],structured:!0,files:["common","script"]},XY:{id:"xy",languages:["qid","ja-Hrkt","ja","en","fr","it","de","es","ko"],structured:!0,version:"1.5",files:["common","script"]},OmegaRubyAlphaSapphire:{id:"oras",languages:["qid","ja-Hrkt","ja","en","fr","it","de","es","ko"],structured:!0,version:"1.4",files:["common","script"]},SunMoon:{id:"sm",languages:["qid","ja-Hrkt","ja","en","fr","it","de","es","ko","zh-Hans","zh-Hant"],structured:!0,version:"1.2",files:["common","script"],speaker:{file:"common",textFile:"58"}},UltraSunUltraMoon:{id:"usum",languages:["qid","ja-Hrkt","ja","en","fr","it","de","es","ko","zh-Hans","zh-Hant"],structured:!0,version:"1.2",files:["common","script"],speaker:{file:"common",textFile:"63"}},LetsGoPikachuLetsGoEevee:{id:"lgpe",languages:["qid","ja-Hrkt","ja","en","fr","it","de","es","ko","zh-Hans","zh-Hans-CN","zh-Hant"],structured:!0,version:"1.0.0/1.0.1/1.0.2",files:["common","script"]},SwordShield:{id:"swsh",languages:["qid","ja-Hrkt","ja","en","fr","it","de","es","ko","zh-Hans","zh-Hant"],structured:!0,version:"1.3.0/1.3.1/1.3.2",files:["common","script"],speaker:{file:"common",textFile:"namelist"}},BrilliantDiamondShiningPearl:{id:"bdsp",languages:["qid","ja-Hrkt","ja","en","fr","it","de","es","ko","zh-Hans","zh-Hant"],structured:!0,version:"1.3.0",files:["message"],speaker:{file:"message",textFile:"dlp_speakers_name"}},LegendsArceus:{id:"la",languages:["qid","ja","en","fr","it","de","es","ko","zh-Hans","zh-Hant"],structured:!0,version:"1.1.0/1.1.1",files:["common","script"],speaker:{file:"common",textFile:"namelist"}},ScarletViolet:{id:"sv",languages:["qid","ja","en","fr","it","de","es","ko","zh-Hans","zh-Hant"],structured:!0,version:"3.0.1",files:["common","script"],speaker:{file:"common",textFile:"namelist"}},Stadium:{id:"stad",languages:["qid","en","fr","it","de","es"],structured:!0,files:["msg"]},Stadium2:{id:"stad2",languages:["qid","ja-Hrkt","en","fr","it","de","es"],structured:!0,files:["msg"]},Box:{id:"box",languages:["qid","ja-Hrkt","en","en-GB","fr","it","de","es"],structured:!0,files:["message"]},Colosseum:{id:"colo",languages:["qid","ja","en","en-GB","fr","it","de","es"],structured:!0,files:["msg"]},XD:{id:"xd",languages:["qid","ja","en","en-GB","fr","it","de","es"],structured:!0,files:["msg"]},BattleRevolution:{id:"pbr",languages:["qid","ja","en","en-GB","fr","it","de","es"],structured:!0,version:{ja:"0/1/2",en:"0","en-GB":"0",fr:"0",it:"0",de:"0",es:"0"},files:["message"],literals:{'"No."':{branch:"language",line:{ja:992,en:993,"en-GB":993,de:994,fr:995,es:996,it:997}},'"Lv."':{branch:"language",line:{ja:998,en:999,"en-GB":999,de:1e3,fr:1001,es:1002,it:1003}},'"HP"':{branch:"language",line:{ja:1036,en:1037,"en-GB":1037,de:1038,fr:1039,es:1040,it:1041}},'"PP"':{branch:"language",line:{ja:1042,en:1043,"en-GB":1043,de:1044,fr:1045,es:1046,it:1047}}}},Ranch:{id:"ranch",languages:["qid","ja-Hrkt","en","en-GB","fr","it","de","es"],structured:!0,version:{"ja-Hrkt":"258",en:"256","en-GB":"1",fr:"1",it:"1",de:"1",es:"1"},files:["msg"]},Bank:{id:"bank",languages:["qid","ja-Hrkt","ja","en","fr","it","de","es","ko","zh-Hans","zh-Hant"],structured:!0,version:"1.5",files:["turtle"]},HOME:{id:"home",languages:["qid","ja-Hrkt","ja","en","fr","it","de","es","ko","zh-Hans","zh-Hant"],structured:!0,version:"3.2.1",files:["megaturtle"]},GO:{id:"go",languages:["qid","ja","en","fr","it","de","es","es-419","ko","zh-Hant","pt-BR","th","ru","tr","id","hi"],structured:!0,softWrap:!0,files:["text"]},Masters:{id:"masters",languages:["qid","ja","en","fr","it","de","es","ko","zh-Hant"],structured:!0,softWrap:!0,files:["messages","talk","ui"]}},Re={languages:Ne,collections:qe},H="qid",Me="zxx",h=Re,_=["exact","regex","boolean"],le=e=>_.includes(e),z=Object.keys(h.collections),Ie=z.filter(e=>h.collections[e].structured),ie={id:"",file:"",query:"",type:"exact",caseInsensitive:!0,common:!0,script:!0,showAllLanguages:!0,collections:Ie,languages:h.languages,run:!1};function ze(e){const s={};return e.id!==void 0&&(s.id=e.id),e.file!==void 0&&(s.file=e.file),e.run!==void 0&&(s.run=e.run.toString()),new URLSearchParams({query:e.query,type:e.type,caseInsensitive:e.caseInsensitive.toString(),common:e.common.toString(),script:e.script.toString(),showAllLanguages:e.showAllLanguages.toString(),collections:e.collections.join(","),languages:e.languages.join(","),...s}).toString()}function Pe(e){const s=new URLSearchParams(e);return{id:N(s.get("id")),file:N(s.get("file")),query:N(s.get("query")),type:$e(s.get("type")??(s.get("regex")==="true"?"regex":null),le),caseInsensitive:P(s.get("caseInsensitive")),common:P(s.get("common")),script:P(s.get("script")),showAllLanguages:P(s.get("showAllLanguages")),collections:ne(s.get("collections"),z),languages:ne(s.get("languages"),h.languages,Te),run:P(s.get("run"))}}function N(e){return e??void 0}function P(e){switch(e){case"true":return!0;case"false":return!1}}function $e(e,s){if(e!==null&&s(e))return e}function ne(e,s,n=a=>a){if(e!==null)return e.split(",").map(n).filter(a=>s.includes(a))}function Te(e){switch(e){case"qid-ZZ":case"ja-JP":case"en-US":case"fr-FR":case"it-IT":case"de-DE":case"es-ES":case"ko-KR":return e.split("-",1)[0];case"ja-Hrkt-JP":return"ja-Hrkt";case"zh-CN":return"zh-Hans";case"zh-TW":return"zh-Hant";default:return e}}const Oe=z.length^h.languages.length<<4,$=2,Z=Math.ceil(h.languages.length/8),Ve=Math.ceil(z.length/8),ce=$+Z+Ve,Ge=e=>btoa(String.fromCodePoint(...e)).replaceAll("/","_").replaceAll("+","-").replace(/=+$/,""),_e=e=>Uint8Array.from(atob(e.replaceAll("_","/").replaceAll("-","+")),s=>s.codePointAt(0));function Ue(e){const s={};e.id!==void 0&&(s.id=e.id),e.file!==void 0&&(s.file=e.file);const n=Ye(e);return Ke(n),new URLSearchParams({...s,q:e.query,s:Ge(n)}).toString()}function We(e){const s=new URLSearchParams(e),n={id:N(s.get("id")),file:N(s.get("file")),query:N(s.get("q"))},a=N(s.get("s"));if(!a)return n;try{const r=new Uint8Array(ce);return r.set(_e(a).slice(0,r.length)),Xe(r),{...n,...Je(r)}}catch{return n}}function Ye(e){const s=new Uint8Array(ce);return s[1]=+(e.run??ie.run)<<0|+e.caseInsensitive<<1|+e.common<<2|+e.script<<3|_.indexOf(e.type)<<4|+!e.showAllLanguages<<7,h.languages.forEach((n,a)=>{e.languages.includes(n)&&(s[$+Math.floor(a/8)]|=1<<a%8)}),z.forEach((n,a)=>{e.collections.includes(n)&&(s[$+Z+Math.floor(a/8)]|=1<<a%8)}),s}function Je(e){const s=h.languages.filter((a,r)=>(e[$+Math.floor(r/8)]>>r%8&1)===1),n=z.filter((a,r)=>(e[$+Z+Math.floor(r/8)]>>r%8&1)===1);return{run:(e[1]&1)!==0,caseInsensitive:(e[1]&2)!==0,common:(e[1]&4)!==0,script:(e[1]&8)!==0,type:_[(e[1]&48)>>4],showAllLanguages:(e[1]&128)===0,languages:s,collections:n}}function Ke(e){const s=e[0]=ue(e);de(s,e)}function Xe(e){const s=e[0];if(de(s,e),s!==ue(e))throw Error("invalid checksum")}function ue(e,s=1){return e.slice(s).reduce((n,a)=>n+a&255,0)^Oe&255}function de(e,s,n=1){let a=Ze(e);for(let r=n;r<s.length;r++)s[r]^=a>>24,a=Qe(a)}const Ze=e=>2480367069*e&4294967295,Qe=e=>2438952949*e+2654435769&4294967295;function W(e){return(q("corpus-longURL")==="true"?ze:Ue)(e)}function es(e){const s=new URLSearchParams(e);return s.get("q")||s.get("s")?We(e):Pe(e)}function Y(e,s=4){const n=[...e].map(a=>a.codePointAt(0)>255?1:.5).reduce((a,r)=>a+r,0);if(!(n<=s))return{fontSize:`${s*100/n}%`,scale:`1 ${n/s}`,whiteSpace:"nowrap"}}function ss(e){if(e.length===0)return new Set(Object.keys(h.collections));const s=new Set,n=new Set(e);for(const a of Object.keys(h.collections))h.collections[a].languages.some(r=>n.has(r))&&s.add(a);return s}function ts(e){if(e.length===0)return new Set(h.languages);const s=new Set;for(const n of e)for(const a of h.collections[n].languages)s.add(a);return s}function ns({collections:e,languages:s,setCollections:n}){const{t:a}=D(),r=["ja","ko","zh"].some(o=>L.language.startsWith(o)),c=ss(s);return t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"search-collections",children:Object.keys(h.collections).map(o=>[o,a(`collections:${o}.name`),a(`collections:${o}.short`)]).map(([o,d,A])=>t.jsxs("div",{className:`search-collection search-${c.has(o)?"valid":"invalid"}`,children:[t.jsx("input",{type:"checkbox",name:`collection-${o}`,id:`collection-${o}`,checked:e.includes(o),onChange:C=>{if(C.target.checked&&!e.includes(o)){const i=[];i.splice(0,0,...e),i.push(o),n(i)}else!C.target.checked&&e.includes(o)&&n(e.filter(i=>i!==o))}}),t.jsx("label",{htmlFor:`collection-${o}`,style:r?Y(A):void 0,children:t.jsx("abbr",{title:d,children:A})})]},o))}),t.jsxs("div",{className:"item-group",children:[t.jsx("button",{disabled:e.length===Object.keys(h.collections).length,onClick:()=>{n(Object.keys(h.collections))},children:a("selectAll")}),t.jsx("button",{disabled:e.length===0,onClick:()=>{n([])},children:a("deselectAll")})]})]})}function as({collections:e,languages:s,setLanguages:n}){const{t:a}=D(),r=["ja","ko","zh"].some(o=>L.language.startsWith(o)),c=ts(e);return t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"search-languages",children:h.languages.map(o=>[o,a(`languages:${o}.name`),a(`languages:${o}.code`)]).map(([o,d,A])=>t.jsxs("div",{className:`search-language search-${c.has(o)?"valid":"invalid"}`,children:[t.jsx("input",{type:"checkbox",name:`language-${o}`,id:`language-${o}`,checked:s.includes(o),onChange:C=>{if(C.target.checked&&!s.includes(o)){const i=[];i.splice(0,0,...s),i.push(o),n(i)}else!C.target.checked&&s.includes(o)&&n(s.filter(i=>i!==o))}}),t.jsxs("label",{htmlFor:`language-${o}`,children:[t.jsx("span",{className:"search-language-code",children:t.jsx("abbr",{title:d,children:A})}),t.jsx("span",{className:"search-language-name",style:r?Y(d,12):Y(d,15),children:d})]})]},o))}),t.jsxs("div",{className:"item-group",children:[t.jsx("button",{disabled:s.length===h.languages.length,onClick:()=>{n(h.languages)},children:a("selectAll")}),t.jsx("button",{disabled:s.length===0,onClick:()=>{n([])},children:a("deselectAll")})]})]})}function rs({filtersVisible:e,collections:s,setCollections:n,languages:a,setLanguages:r}){return t.jsxs("div",{className:`search-filters search-filters-${e?"show":"hide"}`,children:[t.jsx(ns,{collections:s,languages:a,setCollections:n}),t.jsx("div",{className:"search-filters-divider"}),t.jsx(as,{collections:s,languages:a,setLanguages:r})]})}const y={...ie,languages:h.languages.filter(e=>e.startsWith(L.language.split("-")[0]))||h.languages.filter(e=>e.startsWith("en"))};function os({status:e,postToWorker:s,terminateWorker:n}){const{t:a}=D(),[r,c]=u.useState(""),[o,d]=u.useState(""),[A,C]=u.useState(y.query),[i,g]=u.useState(y.type),[p,B]=u.useState(y.caseInsensitive),[F,f]=u.useState(y.common),[j,b]=u.useState(y.script),[E,I]=u.useState(y.showAllLanguages),[m,S]=u.useState(y.collections),[w,v]=u.useState(y.languages),[k,ee]=u.useState(!1),[T,U]=u.useState((q("corpus-filtersVisible")??(window.location.hash?"false":"true"))!=="false"),O=u.useCallback(()=>{const l=es(window.location.hash.substring(1));l.id!==void 0&&c(l.id),l.file!==void 0&&d(l.file),l.query!==void 0&&C(l.query),l.type!==void 0&&g(l.type),l.caseInsensitive!==void 0&&B(l.caseInsensitive),l.common!==void 0&&f(l.common),l.script!==void 0&&b(l.script),l.showAllLanguages!==void 0&&I(l.showAllLanguages),l.collections!==void 0&&S(l.collections),l.languages!==void 0&&v(l.languages),l.run!==void 0&&ee(l.run),q("corpus-filtersVisible")===null&&U(!l.id&&!l.file&&!l.run&&(!l.query||!l.collections||!l.languages))},[]);u.useEffect(()=>(window.location.hash&&O(),window.addEventListener("hashchange",O),()=>{window.removeEventListener("hashchange",O)}),[O]),u.useEffect(()=>{if(r!==""){const l=r.split(".")[0];s({query:`^${te(r)}$`,type:"regex",caseInsensitive:!1,common:!0,script:!0,showAllLanguages:!0,richText:G(),collections:Object.keys(h.collections).filter(x=>h.collections[x]?.id===l),languages:[H]}),c("")}},[r,s]),u.useEffect(()=>{if(o!==""){const l=o.split(".")[0];s({query:`^${te(o)}\\..*$`,type:"regex",caseInsensitive:!1,common:!0,script:!0,showAllLanguages:!0,richText:G(),collections:Object.keys(h.collections).filter(x=>h.collections[x]?.id===l),languages:[H]}),d("")}},[o,s]),u.useEffect(()=>{if(k){const l={query:A,type:i,caseInsensitive:p,common:F,script:j,showAllLanguages:E,richText:G(),collections:m,languages:w};window.location.hash=W(l),s(l),ee(!1)}},[k,s]);const fe=l=>{l.preventDefault(),q("corpus-filtersVisible")||R("corpus-filtersVisible",T.toString());const x=document.getElementsByClassName("view-search").item(0);x&&x.scrollHeight>x.clientHeight&&U(!1);const se={query:A,type:i,caseInsensitive:p,common:F,script:j,showAllLanguages:E,richText:G(),collections:m,languages:w};window.location.hash=W(se),s(se)},me=()=>{n()},Ce=()=>{const l=!T;U(l),R("corpus-filtersVisible",l.toString())},Ae=l=>{const x=l.target.value;le(x)&&g(x)},V=X.includes(e),Be=V||A.length===0||m.length===0||w.length===0||e==="waiting";return t.jsxs("form",{className:"search search-form",role:"search",onSubmit:fe,children:[t.jsxs("div",{className:"search-bar",children:[t.jsxs("div",{className:"item-group",children:[t.jsx("label",{htmlFor:"query",children:a("query")}),t.jsx("input",{type:"text",name:"query",id:"query",value:A,onChange:l=>C(l.target.value)}),t.jsxs("div",{className:"btn-alternate-container",children:[t.jsx("input",{id:"submit",type:"submit",className:V?"invisible":"visible",value:a("search"),disabled:Be}),t.jsx("button",{type:"button",className:V?"visible":"invisible",onClick:me,disabled:!V,children:a("cancel")})]}),t.jsx("button",{type:"button",className:T?"active":void 0,onClick:Ce,children:a("filters")}),t.jsx("select",{name:"type",id:"type",onChange:Ae,value:i,title:a("searchType.searchType"),"aria-label":a("searchType.searchType"),children:_.map(l=>t.jsx("option",{value:l,children:a(`searchType.${l}`)},l))})]}),t.jsxs("div",{className:"item-group search-option-group",children:[t.jsxs("div",{className:"search-option",children:[t.jsx("input",{type:"checkbox",name:"caseInsensitive",id:"caseInsensitive",checked:p,onChange:l=>B(l.target.checked)}),t.jsx("label",{htmlFor:"caseInsensitive",children:a("caseInsensitive")})]}),t.jsxs("div",{className:"search-option",children:[t.jsx("input",{type:"checkbox",name:"common",id:"common",checked:F,onChange:l=>f(l.target.checked)}),t.jsx("label",{htmlFor:"common",children:a("common")})]}),t.jsxs("div",{className:"search-option",children:[t.jsx("input",{type:"checkbox",name:"script",id:"script",checked:j,onChange:l=>b(l.target.checked)}),t.jsx("label",{htmlFor:"script",children:a("script")})]}),t.jsxs("div",{className:"search-option",children:[t.jsx("input",{type:"checkbox",name:"showAllLanguages",id:"showAllLanguages",checked:E,onChange:l=>I(l.target.checked)}),t.jsx("label",{htmlFor:"showAllLanguages",children:a("showAllLanguages")})]})]})]}),t.jsx(rs,{filtersVisible:T,collections:m,setCollections:S,languages:w,setLanguages:v})]})}function ls({src:e,active:s=!0}){const n=u.useRef(null);return u.useEffect(()=>{n.current?.classList.add("spinner-stopped")},[]),u.useEffect(()=>{const a=n.current;if(a!==null){const r=()=>{s||a.classList.add("spinner-stopped")};return a.addEventListener("animationiteration",r),()=>{a.removeEventListener("animationiteration",r)}}},[s]),t.jsx("img",{ref:n,className:`spinner ${s?"spinner-active":"spinner-inactive"}`,src:e,alt:""})}function is({progress:e}){const{t:s}=D(),n=Math.min(Math.max(0,e*100),100);return t.jsxs("div",{className:"progress-bar-container",role:"progressbar","aria-label":s("progressBar.title"),"aria-valuenow":n,children:[t.jsx("div",{className:"progress-bar",children:t.jsx("div",{className:"progress-bar-complete",style:{width:`${n}%`}})}),t.jsx("div",{className:"progress-bar-text",children:s("progressBar.value",be(e))})]})}function cs({hash:e}){const{t:s}=D(),n=a=>{const r=new URL(window.location.href);r.hash=e,"share"in navigator&&(a.preventDefault(),navigator.share({url:r.toString()}))};return t.jsx("a",{href:e,rel:"bookmark noreferrer",target:"_blank",title:s("share"),onClick:n,children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",height:"1em",viewBox:"0 0 512 512",children:t.jsx("path",{d:"M307 34.8c-11.5 5.1-19 16.6-19 29.2v64H176C78.8 128 0 206.8 0 304C0 417.3 81.5 467.9 100.2 478.1c2.5 1.4 5.3 1.9 8.1 1.9c10.9 0 19.7-8.9 19.7-19.7c0-7.5-4.3-14.4-9.8-19.5C108.8 431.9 96 414.4 96 384c0-53 43-96 96-96h96v64c0 12.6 7.4 24.1 19 29.2s25 3 34.4-5.4l160-144c6.7-6.1 10.6-14.7 10.6-23.8s-3.8-17.7-10.6-23.8l-160-144c-9.4-8.5-22.9-10.6-34.4-5.4z",fill:"currentColor"})})})}function us({hash:e,callback:s}){const{t:n}=D();return t.jsx("a",{href:e,rel:"bookmark noreferrer",title:n("viewNearby"),onClick:s,children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",height:"1em",viewBox:"-64 0 512 512",children:t.jsx("path",{d:"M64 464c-8.8 0-16-7.2-16-16V64c0-8.8 7.2-16 16-16H224v80c0 17.7 14.3 32 32 32h80V448c0 8.8-7.2 16-16 16H64zM64 0C28.7 0 0 28.7 0 64V448c0 35.3 28.7 64 64 64H320c35.3 0 64-28.7 64-64V154.5c0-17-6.7-33.3-18.7-45.3L274.7 18.7C262.7 6.7 246.5 0 229.5 0H64zm56 256c-13.3 0-24 10.7-24 24s10.7 24 24 24H264c13.3 0 24-10.7 24-24s-10.7-24-24-24H120zm0 96c-13.3 0-24 10.7-24 24s10.7 24 24 24H264c13.3 0 24-10.7 24-24s-10.7-24-24-24H120z",fill:"currentColor"})})})}function ds({callback:e}){const{t:s}=D();return t.jsx("button",{className:"link",title:s("copy"),onClick:e,children:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",height:"1em",viewBox:"-64 0 512 512",children:t.jsx("path",{d:"M208 0H332.1c12.7 0 24.9 5.1 33.9 14.1l67.9 67.9c9 9 14.1 21.2 14.1 33.9V336c0 26.5-21.5 48-48 48H208c-26.5 0-48-21.5-48-48V48c0-26.5 21.5-48 48-48zM48 128h80v64H64V448H256V416h64v48c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V176c0-26.5 21.5-48 48-48z",fill:"currentColor"})})})}function hs(e,s,n,a){return e.replaceAll(/<a class="speaker" data-var="(.+?)">(.+?)<\/a>/gu,(r,c,o)=>`<a class="speaker" href="#${W({query:c,type:"exact",caseInsensitive:!1,common:!1,script:!0,showAllLanguages:!1,collections:[s],languages:[n],run:!0})}" title="${a}">${o}</a>`)}const gs=(e,s)=>s===H?e.replaceAll(/([._/]|([a-z])(?=[A-Z])|([A-Za-z])(?=[0-9]))/gu,"$1<wbr>"):e;function fs(){const{t:e}=D();return t.jsx("div",{className:"results-rendering",children:e("status.rendering")})}function ms({id:e}){return t.jsx("td",{className:"results-table-actions-cell",children:t.jsxs("div",{className:"results-table-actions",children:[t.jsx(cs,{hash:`#id=${e}`}),t.jsx(us,{hash:`#file=${e.split(".").slice(0,-1).join(".")}`})]})},"actions")}function Cs({collection:e,file:s,languages:n,lines:a,showId:r}){const{t:c}=D(),o=n.indexOf(H),d=n.map(f=>f===H?Me:f),A=c("viewSpeaker"),C=h.collections[e].speaker!==void 0,i=d.map(f=>L.dir(f)),g=i.every(f=>f===i[0]),p=u.useRef(null),B=()=>{const f=p.current,j=window.getSelection();j!==null&&f!==null&&(j.removeAllRanges(),j.selectAllChildren(f),document.execCommand("copy"),j.removeAllRanges())},F=["results-table",`collection-${h.collections[e].id??e.toLowerCase()}`,`file-${s}`];return h.collections[e].softWrap===!0&&F.push("soft"),t.jsx("div",{className:"results-table-container",children:t.jsxs("table",{ref:p,className:F.join(" "),children:[t.jsx("thead",{children:t.jsxs("tr",{children:[o!==-1&&t.jsx("th",{className:"results-table-actions-cell",children:t.jsx(ds,{callback:B})}),n.filter(f=>r||f!==H).map(f=>t.jsx("th",{children:t.jsx("abbr",{title:c(`languages:${f}.name`),children:c(`languages:${f}.code`)})},f))]})}),t.jsx("tbody",{dir:g&&i[0]!==L.dir()?i[0]:void 0,children:a.map((f,j)=>t.jsxs("tr",{"data-id":o!==-1?f[o]:void 0,children:[o!==-1&&t.jsx(ms,{id:f[o]}),f.map((b,E)=>r||n[E]!==H?t.jsx("td",{lang:d[E],dir:g?void 0:i[E],dangerouslySetInnerHTML:{__html:gs(C?hs(b,e,n[E],A):b,n[E])}},E):void 0)]},j))})]})})}function As({lines:e,index:s,sectionOffset:n,offset:a,limit:r,onShowSection:c,...o}){const{t:d}=D(),A=Math.max(0,Math.min(e.length,a-n)),C=Math.max(0,Math.min(e.length,a+r-n)),i=A!==0||C!==void 0?e.slice(A,C):e;return t.jsxs(t.Fragment,{children:[A!==0&&t.jsx("button",{className:"results-notice",onClick:c(n,s),children:d("tablePartial",{count:A})}),A!==C&&t.jsx(Cs,{...o,lines:i},s),C!==void 0&&C<e.length&&t.jsx("button",{className:"results-notice",onClick:c(n+C,s),children:d("tablePartial",{count:e.length-C})})]})}function Bs({className:e,results:s,headers:n,showId:a,offset:r,limit:c,onShowSection:o,jumpTo:d}){const[A,C]=u.useState([]),[i,g]=u.useTransition();return u.useEffect(()=>{g(async()=>{let p=0;const B=[];for(const[F,f]of s.entries())B.push(t.jsx(As,{...f,index:F,sectionOffset:p,offset:r,limit:c,showId:a,onShowSection:o})),p+=f.lines.length;C(B)})},[s,c,r]),u.useEffect(()=>{let p=0;for(const[B,{lines:F}]of s.entries()){if(r>=p&&r<p+F.length){d(B);break}p+=F.length}},[r]),t.jsx("main",{id:"results",className:e,children:s.map(({displayHeader:p},B)=>t.jsxs("section",{id:`results-section${B}`,className:"results-section",children:[t.jsx("h2",{className:p?void 0:"d-none",children:n[B]}),i?t.jsx(fs,{}):A[B]]},n[B]))})}function J(e){const s=document.getElementById("results"),n=document.getElementById("results-section0"),a=document.getElementById(`results-section${e}`);s&&n&&a&&(s.scrollTop=a.offsetTop-n.offsetTop)}function ps({headers:e}){const{t:s}=D();return t.jsx("nav",{className:"results-jump",children:t.jsxs("select",{name:"jump",id:"jump",onChange:n=>J(Number(n.target.value)),value:"",children:[t.jsx("option",{value:"",disabled:!0,children:s("jumpTo")}),e.map((n,a)=>(a===0||e[a-1]!==n)&&t.jsx("option",{value:a,children:n},a))]})})}function Es({count:e,offset:s,limit:n,setOffset:a}){const{t:r}=D();return t.jsxs("div",{className:"results-nav",children:[t.jsxs("div",{children:[t.jsx("span",{className:"results-nav-range-long",children:r("displayedRange.long",{count:e,start:s+1,end:Math.min(e,s+n)})}),t.jsx("span",{className:"results-nav-range-short",children:r("displayedRange.short",{count:e,start:s+1,end:Math.min(e,s+n)})})]}),t.jsx("button",{className:"button-square",disabled:s===0,onClick:()=>a(Math.max(0,s-n)),title:r("loadPrev"),children:r("loadPrevIcon",{limit:n})}),t.jsx("button",{className:"button-square",disabled:s+n>=e,onClick:()=>a(Math.min(Math.floor(e/n)*n,s+n)),title:r("loadNext"),children:r("loadNextIcon",{limit:n})})]})}function Ds({status:e,progress:s,results:n,showId:a=!0,richText:r=!0,limit:c=xe}){const{t:o}=D(),[d,A]=u.useState(!0),[C,i]=u.useState(!1),[g,p]=u.useState(2),[B,F]=u.useState(0),[f,j]=u.useState(!0),[b,E]=u.useState(0),I=(v,k)=>()=>{E(v),J(k)};u.useEffect(()=>{E(0)},[n]);const m=u.useMemo(()=>n.map(({collection:v,file:k})=>o("tableHeader",{collection:o(`collections:${v}.name`),file:o(`files:${k}`),interpolation:{escapeValue:!1}})),[n,L.language]),S=u.useMemo(()=>n.map(v=>v.lines.length).reduce((v,k)=>v+k,0),[n]),w=t.jsxs("div",{className:"results-toggle",children:[t.jsx("button",{className:d?"button-square active":"button-square",disabled:!r,onClick:()=>{A(!d)},title:o("showVariables"),children:o("showVariablesIcon")}),t.jsx("button",{className:C?"button-square active":"button-square",disabled:!r,onClick:()=>{i(!C)},title:o("showAllCharacters"),children:o("showAllCharactersIcon")}),t.jsx("button",{className:g!==2?"button-square active":"button-square",disabled:!r,onClick:()=>{p((g+1)%3)},title:o("showGender"),children:o("showGenderIcon",{context:g})}),t.jsx("button",{className:B!==0?"button-square active":"button-square",disabled:!r,onClick:()=>{F((B+1)%3)},title:o("showPlural"),children:o("showPluralIcon",{context:B})}),t.jsx("button",{className:f?"button-square active":"button-square",disabled:!r,onClick:()=>{j(!f)},title:o("showFurigana"),children:t.jsx("span",{className:"results-toggle-furigana",children:o("showFuriganaIcon")})})]});return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"search results-status",children:[m.length>1?t.jsx(ps,{headers:m}):t.jsx("div",{className:"results-status-text",children:o(`status.${e.split(".",1)[0]}`)}),t.jsx(ls,{src:ve,active:X.includes(e)}),S>c?t.jsx(Es,{count:S,offset:b,limit:c,setOffset:E}):t.jsx(is,{progress:s}),w]}),t.jsx(Bs,{className:`search results app-window variables-${d?"show":"hide"} control-${C?"show":"hide"} gender-${g} number-${B} furigana-${f?"show":"hide"} rich-text-${r?"enabled":"disabled"}`,results:n,headers:m,showId:a,offset:b,limit:c,onShowSection:I,jumpTo:J})]})}const Fs=[["805868F0",451848],["FE0A4516",184505],["0E6B4AFC",186358],["38089687",184678],["C8E18522",192736],["AC075F40",185187],["BC8E428D",451830],["E0EDED5F",452016],["AE888233",184382],["42CE5E23",186162],["49A1D761",184638],["E6BE2C39",192693],["EEE6AA0B",184987],["D0A898D8",914491],["B4916E10",247699],["9353A098",247605],["01E40379",247360],["B9271014",255341],["7A3C7531",247525],["93D27A9D",853930],["50D2D70E",371161],["297D48D7",423562],["9E40D227",443434],["7E45FF40",433301],["E53FA927",443211],["DB38E4EE",716552],["F5DB65C4",853759],["CB8106C0",371328],["847BC0BC",423799],["F4F9E121",443569],["31E85F86",433496],["CCEB35BA",443147],["B5AC5376",716517],["C258E1C0",1188380],["AA0CCAD6",516532],["061F929E",583183],["9EB0BB7D",617996],["3154E257",605519],["287D9986",626416],["1B6B811F",56247],["47F479B5",219921],["E98655B9",240723],["A5BA82AE",251904],["66BF6AE1",243507],["24BE0C34",265357],["48268292",253204],["15DA0A67",80381],["B5C9124E",206414],["D50DFB6F",212463],["8BDC97A0",209249],["7F5DBF9C",203357],["BAFD4554",223099],["79526023",209842],["464B1550",105715],["51475FA2",326267],["C1B05D7D",337789],["B91D2631",351308],["3F0AD689",343626],["812A1AB9",378330],["AA61A5BF",362267],["2B0D4B93",43358],["5904163D",376708],["EDD0E9E7",388614],["127039EB",388665],["D5FDB9AE",400933],["C7B1655B",389346],["1EFE3353",417115],["63F8BA72",391961],["ECFF31F9",360643],["3A1A9B1D",65345],["598865DB",612597],["9FC7F04F",658341],["724DB29C",658264],["064910D4",684430],["85A41B08",667743],["F0A6E5C4",718659],["C2700D4A",670855],["FEEB02C7",619191],["4D550F2C",73843],["5A4CAD20",706150],["24945ACB",647415],["5C256E39",661940],["A0E65FD8",661900],["1853AD06",741198],["F1A542E7",663250],["F486A32C",641976],["9C34BDCD",74122],["B7574077",14277],["F995C30A",418914],["9D60674E",238161],["30FC1626",431312],["0F0B9315",251501],["2BD96831",427975],["B2A835DB",231433],["C25D8FD2",440869],["B4D5380B",253667],["19CCEDE0",435286],["A7392F1D",238116],["21A4F991",471647],["F5456BBE",286258],["319F6C84",434313],["D35D93AA",255061],["3202D6A1",432445],["5821F1C6",228581],["8098B211",108529],["DA8465B6",23285],["D986A44C",689295],["D26EF998",345597],["6788D3EB",725690],["D853AAFB",366512],["809A966C",661231],["71BD1A82",321837],["A7E66C77",686073],["6263F6C4",364277],["1C541F50",676483],["80392CBD",345983],["8C28A3B1",743806],["5C726113",400249],["E4D9A8A1",709524],["F010E441",388964],["611CB7AE",654063],["270BED6B",326680],["F9AC014E",41653],["7CBC93B4",13564],["5D77F2D3",290600],["19096712",193156],["99B3AF25",304677],["7EF08E1A",204728],["DCB617AB",309647],["33EF4A6B",218185],["B199F277",317847],["E4933814",237126],["C3A6023B",305573],["34ECA43C",204825],["4E05F7C3",331242],["B9A4C5A5",249282],["719F6CF7",336580],["D4C5FC1F",253405],["B779A7AA",293411],["AB306EB4",193921],["D0453ADC",52057],["A49819C8",20978],["D5E64271",361359],["81DC14F2",251358],["607BD37E",380246],["79364FB4",267071],["C6F7E9BB",391949],["55CB3423",261236],["F3C1F5D1",412072],["A445144E",275169],["04BED485",395485],["32F9174D",249289],["4C011AA6",431932],["3B6F2B5D",311428],["A159FCC1",426053],["EFBA305C",281565],["9727DB13",363094],["00F9CD07",247291],["66850A84",49635],["F7C003F5",19275],["D6E2E088",251306],["3A9A986B",221524],["FC0C8ADD",262055],["3155AD9B",234129],["36A24DD7",264111],["7DE90361",266183],["B1B911A6",281427],["D154C0F5",292914],["914BC9E8",269703],["FCB58A19",255431],["73318A95",286031],["1DACFB2B",294363],["E024B96B",284632],["0482085E",291207],["DBACF489",250082],["9EEA28B7",220906],["6C6BDA9A",248873],["615402EC",225468],["E7763E5F",251831],["DCF080B4",228710],["E9064BC7",57142],["515C63BC",30391],["B029ECEF",287029],["D7459F7B",351512],["C2849705",299536],["76226F39",371546],["925DA459",304276],["1332A7BF",417674],["1E24F599",322366],["08238B58",462128],["72449731",311083],["4DC4D0F7",410852],["2A36BB82",331386],["B6CCB707",473448],["485DE0B0",327958],["B0BDACD1",465944],["ECDEB54B",285212],["6046FCAE",351632],["8015D11D",285461],["B97E3074",357817],["291B1F2D",289137],["C47A8D10",363279],["56BFFE84",70001],["0F56A27C",17961],["78D61CE1",188757],["3046EC50",91141],["AB01F4D4",195222],["EAEAC744",96916],["7BDB3096",185660],["A731DF7B",98146],["79D3F3B5",196364],["90DADB7E",112741],["3CD179DB",189954],["3CA333A8",100965],["8D12AA04",201217],["DE0762F4",122416],["C3639674",195797],["3449002C",112911],["D23A1D38",186937],["70B92862",92474],["920D68A3",183962],["38CB3189",99595],["4A2AF0BD",183355],["0C39B49A",99105],["9CFCB04F",185584],["24056C87",98436],["F88C7D51",109707],["D06EC6B0",47268],["BC465CEB",327255],["DABDD117",249057],["DB6499F8",343106],["A1E9A260",263024],["2E39FF52",353598],["D72D5490",301521],["E97E3DEA",360374],["C14BE010",316566],["B243A50B",354609],["6DD06B2E",294483],["71E64CE2",374758],["B755DFD7",338573],["D675ED02",354540],["C109C728",315868],["099C8225",334519],["ACBD302C",263043],["CAAB3D17",340926],["3239020C",280033],["94E2F348",339910],["7DD6502E",283225],["A3C49BBF",99393],["87647E62",438279],["9616FC8D",459527],["A2BCEA38",441003],["224162EA",473430],["1B465C57",456582],["FF560BEE",502888],["690BFF6E",465097],["1C088BF9",412634],["BDB8EF03",416941],["EC2A02E5",430970],["868957D1",74049],["A142B3F1",24108],["AE7A3398",217519],["5F77F1A4",230194],["C7DC5911",212569],["EFC20517",250558],["B1E9377A",212889],["C74A122A",247223],["D054DE70",207469],["CE8B0601",241619],["ED88D7E1",217691],["FC76E487",250690],["D766E68F",209904],["0B78B3D6",250516],["7707196A",196581],["D6E20DF4",198422],["AEE9875F",197067],["7F1BE555",196414],["2E5BAC17",197521],["1365CBAA",206782],["9D22F3E2",142866],["1D2F4BF3",71136],["B38DE6C7",428923],["C0C91D78",523598],["99B6F5E4",400940],["D1F7D9A3",527195],["DB66385A",410479],["8D9AFC15",540864],["2A68B3C4",396595],["E0AC173E",500289],["300A80E9",415883],["23719FF4",547694],["B53002F4",401220],["14C7FDE3",535541],["B6B8EBAE",376872],["6D12C9E1",440546],["EDD3DC38",377240],["B2485F5C",432631],["A12D9827",380373],["4C32D9D0",449342],["C3E5FB9D",4339],["8F488338",26442],["C0CC6C78",27488],["C000BF76",26723],["5D8671DF",30377],["38FA9F65",28212],["A8F362C0",43636],["3BF95355",213995],["8B89062A",189456],["BD1820D9",174259],["40824263",181488],["38D29549",211516],["CDD1322A",188971],["9920B1E3",3505],["CCD878B1",11682],["CC445D0F",10530],["A01D9E8C",10488],["3B409C23",11138],["0B197BEA",10982],["4452D813",11317],["D958ECBF",11107],["EA1432F5",14904],["CA9CD9BD",185298],["E266968F",191903],["97ECABBA",187664],["87A27B31",197388],["04872EBD",196569],["8E557D83",204124],["1605EDD5",197879],["26D93D24",11886],["95CC0171",294807],["C46156B1",261280],["9EA398A5",234498],["68062841",229744],["656E796C",230208],["A80BEC67",254904],["A190FDDD",241132],["3356A778",27511],["F8317CFE",168076],["F71850AB",154401],["E554DABC",154242],["C7E7F875",160914],["2C56E000",156325],["A55CCB2E",163853],["DE9A5332",149658],["4028E267",10276],["38B7948A",85967],["B3B75E50",63779],["34A6C0E7",63992],["F1318B98",68269],["CA1ADAA3",67235],["12F3987F",68652],["0E2E5E91",66187],["8EA29A66",28943],["A6D0F48B",252507],["BA9443EB",266550],["886D0304",287489],["606FC990",290952],["DC096C52",284717],["A25EDA41",300791],["B5DC512F",288797],["41303CFE",254545],["BF4FC8A0",260380],["7DEBD604",262359],["2439FD69",119685],["45B39AA0",695517],["178F33F9",724549],["34E25F98",770042],["9A31C8AB",773486],["2B197D76",756785],["6CBB2A0F",817937],["64A00033",763166],["B2E49CB7",695621],["DE6516AD",711468],["42A2B796",713699],["263C9FBF",136266],["1F0DDBF5",460816],["947F535A",483604],["69615097",524616],["FA45D0A4",514004],["EA25388B",538704],["81B0A9FD",520086],["CFC08578",512125],["FB209B31",440055],["9422C0AA",459003],["8354ADA6",508950],["C33FDF5E",596815],["DE343A17",620219],["E2DABF90",504250],["299E0488",452806],["1D029264",612251],["9C563962",116829],["936CFF4B",175051],["6A5CCEE5",12247],["729B1F12",307313],["92A3038B",1455263],["3DF63185",60205],["71A86535",294271],["AB4A2952",1437661],["A3E4EEFF",61216],["6DA23890",319354],["3B4D25F5",1629046],["EC26ED52",66682],["3B21C0A1",305845],["3EFD4F1C",1496800],["147EB9E3",63223],["88939CA8",321695],["FF750C35",1682710],["9DB6A189",66994],["1C40D0AC",315335],["45E9C890",1622544],["9EDB5872",64743],["C630BF93",290094],["82A550E1",1372231],["C5336463",56293],["AFCA235D",295966],["716469D0",1459759],["243AF136",54263]],K=(e,s,n)=>`corpus/${e}/${s}_${n}.txt.gz`,js=e=>he(e).size,bs=async(e,s)=>{const[n,a]=await ge(e,s);return a?.hash===n.hash?0:n.size},vs=async e=>{try{const s=await Q(),n=(await Promise.all(e.flatMap(a=>h.collections[a].languages.flatMap(r=>h.collections[a].files.map(c=>bs(s,K(a,r,c))))))).reduce((a,r)=>a+r,0);return s.close(),n}catch{return e.flatMap(s=>h.collections[s].languages.flatMap(n=>h.collections[s].files.map(a=>js(K(s,n,a))))).reduce((s,n)=>s+n,0)}},xs=e=>"/poke-corpus/"+e,Is=async(e,s,n)=>{const a=xs(n),[r,c]=await ge(s,n);return c?.hash!==void 0?[await Ls(e,a),c.hash===r.hash]:[void 0,!1]},ae=Fs,ws=Object.fromEntries(Object.entries(h.collections).flatMap(([e,s])=>s.languages.flatMap(n=>s.files.map(a=>K(e,n,a)))).map((e,s)=>[e,{hash:ae[s][0],size:ae[s][1]}])),Ss="corpus",M="files",Q=()=>{const e=indexedDB.open(Ss);return new Promise((s,n)=>{e.onupgradeneeded=()=>{e.result.createObjectStore(M),e.transaction!==null&&(e.transaction.oncomplete=()=>{console.log("Created object store")})},e.onsuccess=()=>s(e.result),e.onerror=()=>n(e.error)})},he=e=>ws[e],ks=(e,s)=>{const r=e.transaction([M],"readonly").objectStore(M).get(s);return new Promise((c,o)=>{r.onsuccess=()=>c(r.result),r.onerror=()=>o(r.error)})},zs=(e,s)=>{const r=e.transaction([M],"readwrite").objectStore(M).delete(s);return new Promise((c,o)=>{r.onsuccess=()=>c(r.result!==void 0),r.onerror=()=>o(r.error)})},ge=async(e,s)=>[he(s),await ks(e,s)],Ps=()=>Q().then(e=>{const a=e.transaction(["files"],"readwrite").objectStore("files").clear();return e.close(),new Promise((r,c)=>{a.onsuccess=()=>r(a===void 0),a.onerror=()=>c(a.error)})}).catch(e=>new Promise((s,n)=>n(e))),$s=()=>Q().then(e=>{const a=e.transaction([M],"readonly").objectStore(M).getAllKeys();return e.close(),new Promise((r,c)=>{a.onsuccess=()=>r(a.result.filter(o=>typeof o=="string")),a.onerror=()=>c(a.error)})}).catch(e=>new Promise((s,n)=>n(e))),ys="corpus",Ts=async()=>await caches.open(ys),Ls=async(e,s)=>{try{const n=await e.match(s);return n}catch(n){console.error(n);return}},re="corpus-warn",Hs=2e7;function Ns({showModal:e,limit:s}){const{t:n}=D(),a=u.useRef(null),[r,c]=u.useState("initial"),[o,d]=u.useState(0),[A,C]=u.useState(!0),[i,g]=u.useState(!0),[p,B]=u.useState([]),[F,f]=u.useState(q(re)!=="false");u.useEffect(()=>{const m=()=>{a.current!==null&&!X.includes(r)&&(console.log("Terminating worker!"),a.current.terminate(),a.current=null)};return window.addEventListener("blur",m),()=>{window.removeEventListener("blur",m)}},[r]);const j=u.useCallback(m=>{m.data.complete?(c(m.data.status),d(m.data.progress),C(m.data.showId),g(m.data.richText),B(m.data.results),He.includes(m.data.status)&&e({message:n(`statusModal.${m.data.status}`),buttons:[{message:n("statusModal.buttons.ok"),autoFocus:!0}]})):(c(m.data.status),d(m.data.progress))},[]),b=()=>{a.current!==null&&(console.log("Terminating worker!"),a.current.terminate(),a.current=null,c("initial"),d(0))},E=u.useCallback(m=>{B([]),m.query.length>0&&m.collections.length>0&&m.languages.length>0&&(a.current===null&&(console.log("Creating new worker..."),a.current=new Le,a.current.addEventListener("message",j)),d(0),a.current.postMessage(m))},[]),I=u.useCallback(async m=>{if(c("waiting"),F){const S=await vs(m.collections);if(S>Hs){e({message:n("searchModal.message",we(S)),checkbox:{message:n("searchModal.checkboxDoNotShowAgain"),checked:!1},buttons:[{message:n("searchModal.buttons.yes"),callback:()=>E(m),checkboxCallback:w=>{f(!w),R(re,(!w).toString())}},{message:n("searchModal.buttons.no"),callback:()=>c("initial"),autoFocus:!0}],cancelCallback:()=>c("initial")});return}}E(m)},[F]);return t.jsxs(t.Fragment,{children:[t.jsx(os,{status:r,postToWorker:I,terminateWorker:b}),t.jsx(Ds,{status:r,progress:o,showId:A,richText:i,results:p,limit:s})]})}const Os=Object.freeze(Object.defineProperty({__proto__:null,default:Ns},Symbol.toStringTag,{value:"Module"}));export{Ms as O,is as P,Os as S,Q as a,K as b,h as c,Is as d,$s as e,zs as f,Ts as g,vs as h,Ps as i};
