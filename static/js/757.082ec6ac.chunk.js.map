{"version":3,"file":"static/js/757.082ec6ac.chunk.js","mappings":"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","sources":["../node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js","../node_modules/@babel/runtime/helpers/esm/slicedToArray.js","../node_modules/@babel/runtime/helpers/esm/arrayWithHoles.js","../node_modules/@babel/runtime/helpers/esm/iterableToArrayLimit.js","../node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js","../node_modules/@babel/runtime/helpers/esm/nonIterableRest.js","searchWorker.ts"],"sourcesContent":["export default function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n  return arr2;\n}","import arrayWithHoles from \"./arrayWithHoles.js\";\nimport iterableToArrayLimit from \"./iterableToArrayLimit.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableRest from \"./nonIterableRest.js\";\nexport default function _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}","export default function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}","export default function _iterableToArrayLimit(arr, i) {\n  var _i = null == arr ? null : \"undefined\" != typeof Symbol && arr[Symbol.iterator] || arr[\"@@iterator\"];\n  if (null != _i) {\n    var _s,\n      _e,\n      _x,\n      _r,\n      _arr = [],\n      _n = !0,\n      _d = !1;\n    try {\n      if (_x = (_i = _i.call(arr)).next, 0 === i) {\n        if (Object(_i) !== _i) return;\n        _n = !1;\n      } else for (; !(_n = (_s = _x.call(_i)).done) && (_arr.push(_s.value), _arr.length !== i); _n = !0);\n    } catch (err) {\n      _d = !0, _e = err;\n    } finally {\n      try {\n        if (!_n && null != _i[\"return\"] && (_r = _i[\"return\"](), Object(_r) !== _r)) return;\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n    return _arr;\n  }\n}","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nexport default function _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}","export default function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","import corpus from './i18n/corpus.json'\r\n\r\nexport type SearchParams = {\r\n  query: string,\r\n  regex: boolean,\r\n  caseInsensitive: boolean,\r\n  common: boolean,\r\n  script: boolean,\r\n  collections: string[],\r\n  languages: string[]\r\n};\r\n\r\nexport type SearchResults = {\r\n  complete: boolean,\r\n  status: string,\r\n  progress: number,\r\n  resultsLanguages: string[][],\r\n  results: [string, string, string[][]][]\r\n};\r\n\r\n/* eslint-disable no-restricted-globals */\r\nself.onmessage = (message: MessageEvent<SearchParams>) => {\r\n  const cacheVersion = \"v1\";\r\n\r\n  /**\r\n   * Attempts the following, in order:\r\n   * - Retrieving the file from the cache\r\n   * - Populating the cache with the file\r\n   * - Fetching the file directly\r\n   *\r\n   * Returns a promise of the text of the file.\r\n   */\r\n  const getFileFromCache = (collectionKey: string, languageKey: string, fileKey: string) => {\r\n    const url = process.env.PUBLIC_URL + `/corpus/${collectionKey}/${languageKey}_${fileKey}.txt`;\r\n    return caches.open(cacheVersion)\r\n    .then((cache) => cache.match(url).then(res => res\r\n      ?? cache.add(url).then(() => cache.match(url)).then(res => res\r\n        ?? fetch(url))))\r\n    .catch(() => fetch(url))\r\n    .then((res) => res.text())\r\n    .then(preprocessString);\r\n  }\r\n\r\n  // SMUSUM Chinese PokÃ©mon names\r\n  const chineseChars = 'è›‹å¦™è›™ç§å­è‰èŠ±å°ç«é¾™æå–·æ°å°¼é¾Ÿå¡å’ªæ°´ç®­ç»¿æ¯›è™«é“ç”²è›¹å·´å¤§è¶ç‹¬è§’å£³é’ˆèœ‚æ³¢æ¯”é¸Ÿæ‹‰è¾¾çƒˆé›€å˜´é˜¿æŸè›‡æ€ªçš®ä¸˜é›·ç©¿å±±é¼ çŽ‹å¤šå…°å¨œåŽæœ—åŠ›è¯ºå¯è¥¿å…­å°¾ä¹èƒ–ä¸è¶…éŸ³è èµ°è·¯è‡­éœ¸æ´¾æ–¯ç‰¹çƒæ‘©é²è›¾åœ°ä¸‰å–µçŒ«è€é¸­å“¥çŒ´æš´è’‚ç‹—é£Žé€ŸèšŠé¦™èŒèšªå›æ³³å£«å‡¯å‹‡åŸºèƒ¡è…•è±ªå–‡å­èŠ½å£å‘†é£ŸçŽ›ç‘™æ¯æ¯’åˆºæ‹³çŸ³éš†å²©é©¬ç„°å…½ç£åˆä¸€è‘±å˜Ÿåˆ©æµ·ç‹®ç™½æ³¥èˆŒè´é¬¼é€šè€¿å‚¬çœ è²˜å¼•æ¢¦äººé’³èŸ¹å·¨éœ¹é›³ç”µé¡½å¼¹æ¤°æ ‘å˜Žå•¦é£žè…¿éƒŽå¿«å¤´ç“¦åŒçŠ€ç‰›é’»å‰è”“è—¤è¢‹å¢¨é‡‘é±¼æ˜Ÿå®é­”å¢™å¶å¤©èž³èž‚è¿·å”‡å§å‡»ç½—è‚¯æ³°é²¤æ™®ç™¾å˜ä¼Šå¸ƒè¾¹èŠåŒ–ç›”é•°åˆ€ç¿¼æ€¥å†»é—ªä½ å“ˆå…‹å¹»å¶æœˆæ¡‚ç«ºè‘µé”¯é³„è“ç«‹å’•å¤œé¹°èŠ­ç“¢å®‰åœ†ä¸è››å‰å­—ç¯ç¬¼å¤ç„¶å’©ç¾ŠèŒ¸ç¾Žä¸½éœ²æ‰çš‡æ¯½æ£‰é•¿æ‰‹å‘æ—¥èœ»èœ“ä¹Œæ²¼å¤ªé˜³äº®é»‘æš—é¸¦å¦–æœªçŸ¥å›¾è…¾æžœç¿éº’éºŸå¥‡æ¦›ä½›æ‰˜åœŸå¼ŸèŽé’¢åƒå£¶èµ«ç‹ƒç†Šåœˆç†”èœ—çŒªçŠç‘šç‚®ç« æ¡¶ä¿¡ä½¿ç¿…æˆ´åŠ è±¡é¡¿â…¡æƒŠé¹¿çŠ¬æ— ç•æˆ˜èˆžå¨ƒå¥¶ç½å¹¸ç¦å…¬ç‚Žå¸å¹¼æ²™ç­æ´›äºšå‡¤æ—¶æœ¨å®ˆå®«æ£®æž—èœ¥èœ´ç¨šé¸¡å£®è·ƒç‹¼çº¹ç›´å†²èŒ§ç‹©çŒŽç›¾ç²‰èŽ²ç«¥å¸½ä¹æ²³æ©¡å®žé¼»ç‹¡çŒ¾å‚²éª¨ç‡•é¸¥èŽ‰å¥ˆæœµæºœç³–é›¨è˜‘è‡æ–—ç¬ æ‡’ç­è¿‡åŠ¨çŒ¿è¯·å‡å±…å¿é¢è€…è„±å¦žå¼çˆ†å¹•ä¸‹æŽŒæœåŒ—ä¼˜é›…å‹¾é­‚çœ¼é‚£æ°å§†è½æ­£æ‹è´Ÿè¤ç”œè”·è–‡æº¶åžç‰™é²¨é²¸é©¼ç…¤ç‚­è·³å™—æ™ƒæ–‘é¢šèšæ¼ ä»™æ­Œé’ç»µä¸ƒå¤•é¼¬æ–©é¥­åŒ™é³…é²¶è™¾å…µèž¯ç§¤å¿µè§¦æ‘‡ç¯®ç¾½ä¸‘çº³é£˜æµ®æ³¡éšæ€¨å½±è¯…å’’å·¡çµå½·å¾¨çƒ­å¸¦é“ƒå‹ƒæ¢­é›ªå†°æŠ¤è±¹çç æ¨±ç©ºæ£˜çˆ±å¿ƒå“‘å±žè‰¾æ¬§ç›–å›ºåç¥ˆä»£å¸Œè‹—å°çŒ›æ›¼æ‹¿å„¿ç‹¸æ³•å¸ˆç®±èŸ€å‹’ä¼¦ç´å«ç¾žè‹žæ§ŒåŸŽç»“è´µå¦‡ç»…èœœå¥³å¸•å…¹æ½œå…”éšå·è€³é­…ä¸œæ–½é“›å“å¦é“œé•œé’Ÿç›†è’å™ªé™†å°–å’¬ä¸è‰¯éª·è§å…‰éœ“è™¹è‡ªèˆ”ç‹‚è¿œï¼ºç”±å¢å¸­æ©éª‘è‰²éœèŽ±è°¢ç±³å°”å®™æä¸»æš–ç‚’æ­¦åˆƒä¸¸å‰‘æŽ¢æ­¥å“¨çº¦æ‰’é…·å†·èš€è±†é¸½é«˜é›‰å¹”åºžæ»šè™èžºé’‰å·®æ¬è¿åŒ ä¿®å»ºèŸ¾èœæŠ•æ‘”æ‰“åŒ…ä¿è¶³èœˆèš£è½¦è½®ç²¾æ ¹è£™é‡Žè›®é²ˆæ··æµæ°“çº¢å€’ç‹’æ®¿æ»‘å·¾å¾å“­å…·æ­»ç¥žæ£ºåŽŸè‚‹å§‹ç¥–ç ´ç°å°˜ç´¢æ²«æ —å¾·å•åµç»†èƒžé€ é¹…å€å››å­£èŒå“Žå‘€è´¥è½»èœ˜åšé½¿ç»„éº»é³—å®‡çƒ›å¹½æ™¶æ–§åšå‡ ä½•æ•æ·åŠŸå¤«çˆ¶èµ¤é©¹åŠˆå¸ä»¤ç‚¸é›„ç§ƒä¸«é¦–æ¶ç‡ƒçƒ§æ¯•äº‘é…‹è¿ªè€¶å¡”èµ›é‡Œç‹å‘±è´ºæŽ˜å½©è““æ´èƒ½éž˜èŠ³èŠ™å¦®å¥½é±¿è´¼è„šé“ åžƒè—»è‡‚æžªä¼žå’šç¢Žé»é’¥æœ½å—ç“œå—¡å“²è£´æ ¼æž­ç‹™å°„ç‚½å’†å“®è™Žæ¼¾å£¬ç¬ƒå•„é“³å°‘å¼ºé”¹å†œèƒœè™»é¬ƒå¼±åé©´ä»”é‡æŒ½æ»´ä¼ªç¡ç½©ç›—ç€ç«¹ç–—çŽ¯æ™ºæŒ¥çŒ©æŽ·èƒ†å™¬å ¡çˆ·å‚æ€§ï¼šé“¶ä¼´é™¨æž•æˆˆè°œæ‹Ÿï¼±ç£¨èˆµé³žæ–ç’žãƒ»é¸£å“žé³ç§‘èŽ«è¿¦è™šå¾è‚Œè´¹æŸè¾‰çº¸å¾¡æœºå¤è›‹å¦™è›™ç¨®å­è‰èŠ±å°ç«é¾æå™´å‚‘å°¼é¾œå¡å’ªæ°´ç®­ç¶ æ¯›èŸ²éµç”²è›¹å·´å¤§è¶ç¨è§’æ®¼é‡èœ‚æ³¢æ¯”é³¥æ‹‰é”çƒˆé›€å˜´é˜¿æŸè›‡æ€ªçš®ä¸˜é›·ç©¿å±±é¼ çŽ‹å¤šè˜­å¨œåŽæœ—åŠ›è«¾å¯è¥¿å…­å°¾ä¹èƒ–ä¸è¶…éŸ³è èµ°è·¯è‡­éœ¸æ´¾æ–¯ç‰¹çƒæ‘©é­¯è›¾åœ°ä¸‰å–µè²“è€é´¨å“¥çŒ´çˆ†è’‚ç‹—é¢¨é€ŸèšŠé¦™èŒèšªå›æ³³å£«å‡±å‹‡åŸºèƒ¡è…•è±ªå–‡å­èŠ½å£å‘†é£Ÿç‘ªç‘™æ¯æ¯’åˆºæ‹³çŸ³éš†å²©é¦¬ç„°ç¸ç£åˆä¸€è”¥å˜Ÿåˆ©æµ·ç…ç™½æ³¥èˆŒè²é¬¼é€šè€¿å‚¬çœ è²˜å¼•å¤¢äººé‰—èŸ¹å·¨éœ¹é‚é›»é ‘å½ˆæ¤°æ¨¹å˜Žå•¦é£›è…¿éƒŽå¿«é ­ç“¦é›™çŠ€ç‰›é‘½å‰è”“è—¤è¢‹å¢¨é‡‘é­šæ˜Ÿå¯¶é­”ç‰†å¶å¤©èž³èž‚è¿·å”‡å§æ“Šç¾…è‚¯æ³°é¯‰æš´æ™®ç™¾è®Šä¼Šå¸ƒé‚ŠèŠåŒ–ç›”é®åˆ€ç¿¼æ€¥å‡é–ƒä½ å“ˆå…‹å¹»è‘‰æœˆæ¡‚ç«ºè‘µé‹¸é±·è—ç«‹å’•å¤œé·¹èŠ­ç“¢å®‰åœ“çµ²è››å‰å­—ç‡ˆç± å¤ç„¶å’©ç¾ŠèŒ¸ç¾Žéº—éœ²æ‰çš‡æ¯½æ£‰é•·æ‰‹å‘æ—¥èœ»èœ“çƒæ²¼å¤ªé™½äº®é»‘æš—é´‰å¦–æœªçŸ¥åœ–é¨°æžœç¿éº’éºŸå¥‡æ¦›ä½›æ‰˜åœŸå¼Ÿè é‹¼åƒå£ºèµ«ç‹ƒç†Šåœˆç†”è¸è±¬çŠç‘šç‚®ç« æ¡¶ä¿¡ä½¿ç¿…æˆ´åŠ è±¡é “â…¡é©šé¹¿çŠ¬ç„¡ç•æˆ°èˆžå¨ƒå¥¶ç½å¹¸ç¦å…¬ç‚Žå¸å¹¼æ²™ç­æ´›äºžé³³æ™‚æœ¨å®ˆå®®æ£®æž—èœ¥èœ´ç¨šé›žå£¯èºç‹¼ç´‹ç›´è¡ç¹­ç‹©çµç›¾ç²‰è“®ç«¥å¸½æ¨‚æ²³æ©¡å¯¦é¼»ç‹¡çŒ¾å‚²éª¨ç‡•é·—èŽ‰å¥ˆæœµæºœç³–é›¨è˜‘è‡æ–—ç¬ æ‡¶çºéŽå‹•çŒ¿è«‹å‡å±…å¿é¢è€…è„«å¦žå¼å¹•ä¸‹æŽŒæœåŒ—å„ªé›…å‹¾é­‚çœ¼é‚£æ°å§†è½æ­£æ‹è² èž¢ç”œè–”è–‡æº¶åžç‰™é¯Šé¯¨é§ç…¤ç‚­è·³å™—æ™ƒæ–‘é¡ŽèŸ»æ¼ ä»™æ­Œé’ç¶¿ä¸ƒå¤•é¼¬æ–¬é£¯åŒ™é°é¯°è¦å…µèž¯ç§¤å¿µè§¸æ–ç±ƒç¾½é†œç´é£„æµ®æ³¡éš±æ€¨å½±è©›å’’å·¡éˆå½·å¾¨ç†±å¸¶éˆ´å‹ƒæ¢­é›ªå†°è­·è±¹çç æ«»ç©ºæ£˜æ„›å¿ƒå•žå±¬è‰¾æ­è“‹å›ºåç¥ˆä»£å¸Œè‹—å°çŒ›æ›¼æ‹¿å…’ç‹¸æ³•å¸«ç®±èŸ€å‹’å€«ç´å«ç¾žè‹žæ§ŒåŸŽçµè²´å©¦ç´³èœœå¥³å¸•èŒ²æ½›å…”éš¨æ²è€³é­…æ±æ–½éºéŸ¿å¦éŠ…é¡é˜ç›†è’å™ªé™¸å°–å’¬ä¸è‰¯éª·å…‰éœ“è™¹è‡ªèˆ”ç‹‚é ï¼ºç”±ç›§å¸­æ©é¨Žè‰²éœèŠè¬ç±³çˆ¾å®™æä¸»æš–ç‚’æ­¦åˆƒä¸¸åŠæŽ¢æ­¥å“¨ç´„æ‰’é…·å†·è•è±†é´¿é«˜é›‰å¹”é¾æ»¾è™èžºé‡˜å·®æ¬é‹åŒ ä¿®å»ºèŸ¾èœæŠ•æ‘”æ‰“åŒ…ä¿è¶³èœˆèš£è»Šè¼ªæ¯¬ç²¾æ ¹è£™é‡Žè »é±¸æ··æµæ°“ç´…å€’ç‹’æ®¿æ»‘å·¾å¾µå“­å…·æ­»ç¥žæ£ºåŽŸè‚‹å§‹ç¥–ç ´ç°å¡µç´¢æ²«æ —å¾·å–®åµç´°èƒžé€ éµå€å››å­£èŒå“Žå‘€æ•—è¼•èœ˜å …é½’çµ„éº»é°»å®‡ç‡­å¹½æ™¶æ–§åšå¹¾ä½•æ•æ·åŠŸå¤«çˆ¶èµ¤é§’åŠˆå¸ä»¤ç‚¸é›„ç¦¿ä¸«é¦–æƒ¡ç‡ƒç‡’ç•¢é›²é…‹è¿ªè€¶å¡”è³½é‡Œç‹å‘±è³€æŽ˜å½©è““æ½”èƒ½éž˜èŠ³èŠ™å¦®å¥½é­·è³Šè…³éŽ§åžƒè—»è‡‚æ§å‚˜å’šç¢Žé»é‘°æœ½å—ç“œå—¡å“²è£´æ ¼æ¢Ÿç‹™å°„ç†¾å’†å“®è™Žæ¼¾å£¬ç¯¤å•„éŠƒå°‘å¼·é¬è¾²å‹è™»é¬ƒå¼±å£žé©¢ä»”é‡æŒ½æ»´å½ç¡ç½©ç›œè‘—ç«¹ç™‚ç’°æ™ºæ®çŒ©æ“²è†½å™¬å ¡çˆºåƒæ€§ï¼šéŠ€ä¼´éš•æž•æˆˆè¬Žæ“¬ï¼±ç£¨èˆµé±—æ–ç’žãƒ»é³´å“žé°­ç§‘èŽ«è¿¦è™›å¾è‚Œè²»æŸè¼ç´™å¾¡æ©Ÿå¤åž’ç£Šç °å¥¥å£˜ç£Šç °ä¸‘å¥§';\r\n  const remapChineseChars = (s: string) => {\r\n    return s.search(/[\\uE800-\\uEE26]/u) === -1 ? s : (\r\n      Array.from(s).map((c) => {\r\n        const codePoint = c.codePointAt(0);\r\n        return (codePoint !== undefined && codePoint >= 0xE800 && codePoint <= 0xEE26) ? chineseChars[codePoint - 0xE800] : c;\r\n      }).join('')\r\n    );\r\n  }\r\n\r\n  // ORAS Korean Braille\r\n  const remapKoreanBraille = (s: string) => {\r\n    return s.search(/[\\u1100-\\u11FF\\uE0C0-\\uE0C7]/u) === -1 ? s : (s\r\n      .replaceAll('\\uE0C0', 'ê·¸ëž˜ì„œ') // geuraeseo\r\n      .replaceAll('\\uE0C1', 'ê·¸ëŸ¬ë‚˜') // geureona\r\n      .replaceAll('\\uE0C2', 'ê·¸ëŸ¬ë©´') // geureomyeon\r\n      .replaceAll('\\uE0C3', 'ê·¸ëŸ¬ë¯€ë¡œ') // geureomeuro\r\n      .replaceAll('\\uE0C4', 'ê·¸ëŸ°ë°') // geureonde\r\n      .replaceAll('\\uE0C5', 'ê·¸') // UNUSED go\r\n      .replaceAll('\\uE0C6', 'ê·¸ë¦¬í•˜ì—¬') // geurihayeo\r\n      .replaceAll('á†¨á…©', 'ê·¸ë¦¬ê³ ') // geurigeo\r\n      .replaceAll('\\uE0C7á„‰', 'á„Š') // ss\r\n      .replaceAll('\\uE0C7á„€', 'á„') // kk\r\n      .replaceAll('\\uE0C7á„ƒ', 'á„„') // tt\r\n      .replaceAll('\\uE0C7á„‡', 'á„ˆ') // pp\r\n      .replaceAll('\\uE0C7á„Œ', 'á„') // jj\r\n      .replaceAll('\\uE0C7', 'á„‰') // unmatched double consonant\r\n      .replaceAll(/([\\u1100-\\u115F])([ì–µì˜¹ìš¸ì˜¥ì—°ìš´ì˜¨ì–¸ì–¼ì—´ì¸ì˜ì„ì€])/gu, (_, initial: string, syllable: string) => initial + syllable.normalize(\"NFD\").substring(1)) // combine initial with abbreviations\r\n      .replaceAll(/([ê°€ë‚˜ë‹¤ë§ˆë°”ì‚¬ìžì¹´íƒ€íŒŒí•˜])([\\u11A8-\\u11FF])/gu, (_, syllable: string, final: string) => syllable.normalize(\"NFD\") + final) // combine abbreviations with final\r\n      .replaceAll(/^[\\u1160-\\u1175]+$/gum, (match) => '\\u115F' + match.split('').join('\\u115F')) // filler for unmatched vowels in strings of unmatched vowels\r\n      .replaceAll(/(?<![\\u1100-\\u115F])([\\u1160-\\u1175])/gu, 'á„‹$1') // add null initial to all other unmatched vowels\r\n      .replaceAll(/([\\u1100-\\u115F])(?![\\u1160-\\u1175]|$)/gum, '$1\\u1160') // filler for unmatched initials\r\n      .replaceAll(/(?<![\\u1160-\\u1175])([\\u11A8-\\u11FF])/gum, '\\u115F\\u1160$1') // filler for unmatched finals\r\n      .normalize()\r\n    );\r\n  }\r\n\r\n  // NDS special characters\r\n  const remapNDSSpecialCharacters = (s: string) => {\r\n    return s.search(/[\\u2460-\\u2487]/u) === -1 ? s : (s\r\n      .replaceAll('\\u2469', 'áµ‰Ê³') // Gen 5 superscript er\r\n      .replaceAll('\\u246A', 'Ê³áµ‰') // Gen 5 superscript re\r\n      .replaceAll('\\u246B', 'Ê³') // Gen 5 superscript r\r\n      .replaceAll('\\u2485', 'áµ‰') // Gen 5 superscript e\r\n    );\r\n  }\r\n\r\n  // 3DS special characters\r\n  const remap3DSSpecialCharacters = (s: string) => {\r\n    return remapChineseChars(remapKoreanBraille(\r\n      s.search(/[\\uE000-\\uE0A8]/u) === -1 ? s : (s\r\n        // System\r\n        .replaceAll('\\uE000', 'â’¶') // A Button\r\n        .replaceAll('\\uE001', 'â’·') // B Button\r\n        .replaceAll('\\uE002', 'â“') // X Button\r\n        .replaceAll('\\uE003', 'â“Ž') // Y Button\r\n        .replaceAll('\\uE004', 'â“') // L Button\r\n        .replaceAll('\\uE005', 'â“‡') // R Button\r\n        .replaceAll('\\uE006', 'âœœ') // Control Pad\r\n        .replaceAll('\\uE073', 'ðŸ ï¸Ž') // Home Button\r\n\r\n        // PokÃ©mon private use\r\n        .replaceAll('\\uE08A', 'áµ‰Ê³') // Superscript er\r\n        .replaceAll('\\uE08B', 'Ê³áµ‰') // Superscript re\r\n        .replaceAll('\\uE08C', 'Ê³') // Superscript r\r\n        .replaceAll('\\uE092', 'â™¥') // Halfwidth eighth note\r\n        .replaceAll('\\uE09A', 'â™ª') // Halfwidth eighth note\r\n        .replaceAll('\\uE0A6', 'áµ‰') // Superscript e\r\n\r\n        // ORAS Braille\r\n        .replaceAll('\\uE081', '.') // French period (dots-256) [UNUSED]\r\n        .replaceAll('\\uE082', ',') // French comma (dots-2) [UNUSED]\r\n        .replaceAll('\\uE083', '.') // Italian period (dots-256) [UNUSED]\r\n        .replaceAll('\\uE084', ',') // Italian comma (dots-2) [UNUSED]\r\n        .replaceAll('\\uE085', '.') // German period (dots-3)\r\n        .replaceAll('\\uE086', ',') // German comma (dots-2) [UNUSED]\r\n        .replaceAll('\\uE087', '.') // Spanish period (dots-3)\r\n        .replaceAll('\\uE088', ',') // Spanish comma (dots-2) [UNUSED]\r\n      )\r\n    ));\r\n  }\r\n\r\n  // Switch special characters\r\n  const remapSwitchSpecialCharacters = (s: string) => {\r\n    return s.search(/[\\uE300-\\uE31C]/u) === -1 ? s : (s\r\n      .replaceAll('\\uE300', '$') // PokÃ©mon Dollar\r\n      .replaceAll('\\uE301', 'A') // Unown A\r\n      .replaceAll('\\uE302', 'B') // Unown B\r\n      .replaceAll('\\uE303', 'C') // Unown C\r\n      .replaceAll('\\uE304', 'D') // Unown D\r\n      .replaceAll('\\uE305', 'E') // Unown E\r\n      .replaceAll('\\uE306', 'F') // Unown F\r\n      .replaceAll('\\uE307', 'G') // Unown G\r\n      .replaceAll('\\uE308', 'H') // Unown H\r\n      .replaceAll('\\uE309', 'I') // Unown I\r\n      .replaceAll('\\uE30A', 'J') // Unown J\r\n      .replaceAll('\\uE30B', 'K') // Unown K\r\n      .replaceAll('\\uE30C', 'L') // Unown L\r\n      .replaceAll('\\uE30D', 'M') // Unown M\r\n      .replaceAll('\\uE30E', 'N') // Unown N\r\n      .replaceAll('\\uE30F', 'O') // Unown O\r\n      .replaceAll('\\uE310', 'P') // Unown P\r\n      .replaceAll('\\uE311', 'Q') // Unown Q\r\n      .replaceAll('\\uE312', 'R') // Unown R\r\n      .replaceAll('\\uE313', 'S') // Unown S\r\n      .replaceAll('\\uE314', 'T') // Unown T\r\n      .replaceAll('\\uE315', 'U') // Unown U\r\n      .replaceAll('\\uE316', 'V') // Unown V\r\n      .replaceAll('\\uE317', 'W') // Unown W\r\n      .replaceAll('\\uE318', 'X') // Unown X\r\n      .replaceAll('\\uE319', 'Y') // Unown Y\r\n      .replaceAll('\\uE31A', 'Z') // Unown Z\r\n      .replaceAll('\\uE31B', '!') // Unown !\r\n      .replaceAll('\\uE31C', '?') // Unown ?\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Converts private use characters to the corresponding Unicode characters.\r\n   *\r\n   * Returns the resulting string.\r\n   */\r\n  const preprocessString = (s: string) => {\r\n    return remapSwitchSpecialCharacters(remap3DSSpecialCharacters(remapNDSSpecialCharacters(s)));\r\n  }\r\n\r\n  /**\r\n   * Converts the provided string to HTML by escaping `<` and `>`,\r\n   * replacing line break control characters such as  `\\n` with `<br>`,\r\n   * and converting the ruby syntax `{base|ruby}` to the corresponding HTML tags.\r\n   *\r\n   * Returns the resulting HTML string.\r\n   */\r\n  const postprocessString = (s: string) => {\r\n    return (s.replaceAll('<', '&lt;').replaceAll('>', '&gt;')\r\n      .replaceAll('\\u2486', '<sup>P</sup><sub>K</sub>') // Gen 5 PK\r\n      .replaceAll('\\u2487', '<sup>M</sup><sub>N</sub>') // Gen 5 MN\r\n      .replaceAll('\\uE0A7', '<sup>P</sup><sub>K</sub>') // 3DS PK\r\n      .replaceAll('\\uE0A8', '<sup>M</sup><sub>N</sub>') // 3DS MN\r\n      .replaceAll('\\\\r\\\\n', '<span class=\"r\">&#92;r</span><span class=\"n\">&#92;n</span><br>')\r\n      .replaceAll('\\\\c\\\\n', '<span class=\"c\">&#92;c</span><span class=\"n\">&#92;n</span><br>')\r\n      .replaceAll('\\\\r', '<span class=\"r\">&#92;r</span><br>')\r\n      .replaceAll('\\\\c', '<span class=\"c\">&#92;c</span><br>')\r\n      .replaceAll('\\\\n', '<span class=\"n\">&#92;n</span><br>')\r\n      .replaceAll('\\t', '<span class=\"tab\">\\t</span>')\r\n      .replaceAll('[NULL]', '<span class=\"null\">[NULL]</span>')\r\n      .replaceAll('[COMP]', '<span class=\"compressed\">[COMP]</span>')\r\n      .replaceAll(/(\\[VAR [0-9A-F]{4}(?:\\([0-9A-F]{4}(?:,[0-9A-F]{4})*\\))\\])/gu, '<span class=\"var\">$1</span>')\r\n      .replaceAll(/(\\[WAIT \\d+\\])/gu, '<span class=\"wait\">$1</span>')\r\n      .replaceAll(/(\\[~ \\d+\\])/gu, '<span class=\"unused\">$1</span>')\r\n      .replaceAll(/\\{([^|}]+)\\|([^|}]+)\\}/gu, '<ruby>$1<rp>(</rp><rt>$2</rt><rp>)</rp></ruby>') // Switch furigana\r\n      .replaceAll(/^(\\s+)$/gu, '<span class=\"whitespace\">$1</span>')\r\n    );\r\n  };\r\n\r\n  const progressPortionLoading = 0.49;\r\n  const progressPortionProcessing = 0.49;\r\n  const progressPortionCollecting = 0.01; // 0.01 for rendering\r\n\r\n  const updateStatusInProgress = (status: string, loadingProgress: number, processingProgress: number, collectingProgress: number) => {\r\n    const progress = loadingProgress * progressPortionLoading + processingProgress * progressPortionProcessing + collectingProgress * progressPortionCollecting;\r\n    const message: SearchResults = {\r\n      complete: false,\r\n      status: status,\r\n      progress: progress,\r\n      resultsLanguages: [],\r\n      results: []\r\n    };\r\n    postMessage(message);\r\n  };\r\n\r\n  const updateStatusComplete = (status: string, resultsLanguages: string[][] = [], results: [string, string, string[][]][] = []) => {\r\n    const message: SearchResults = {\r\n      complete: true,\r\n      status: status,\r\n      progress: 1.0,\r\n      resultsLanguages: resultsLanguages,\r\n      results: results\r\n    };\r\n    postMessage(message);\r\n  };\r\n\r\n  try {\r\n    const params = message.data;\r\n    updateStatusInProgress('loading', 0, 0, 0);\r\n\r\n    // Clear old caches\r\n    caches.keys().then((keyList) => Promise.all(keyList.filter((key) => key !== cacheVersion).map((key) => caches.delete(key))));\r\n\r\n\r\n    // Load files\r\n    const loadingPromises: [string, string, Promise<[string, string]>[]][] = [];\r\n    const loadingPromisesIndividual: Promise<[string, string]>[] = []; // for progress bar\r\n    Object.keys(corpus.collections).filter((collectionKey) => params.collections.includes(collectionKey)).forEach((collectionKey) => {\r\n      const collection = corpus.collections[collectionKey as keyof typeof corpus.collections];\r\n\r\n      // Do not process collection if it does not include any language being searched\r\n      if (params.languages.every((languageKey) => !collection.languages.includes(languageKey))) {\r\n        return;\r\n      }\r\n\r\n      // Load all files in all languages in the collection\r\n      collection.files\r\n      .filter((fileKey) => !((fileKey === 'common' && !params.common) || (fileKey === 'script' && !params.script)))\r\n      .forEach((fileKey) => {\r\n        const loadingFilePromises = collection.languages.map((languageKey) => getFileFromCache(collectionKey, languageKey, fileKey).then((data) => [languageKey, data] as [string, string]));\r\n        loadingFilePromises.forEach((promise) => loadingPromisesIndividual.push(promise)); // for progress bar\r\n        loadingPromises.push([collectionKey, fileKey, loadingFilePromises] as [string, string, Promise<[string, string]>[]]);\r\n      });\r\n    });\r\n\r\n\r\n    // Process files\r\n    const re = params.regex ? new RegExp(params.query, params.caseInsensitive ? 'ui' : 'u') : null;\r\n    const matchCondition = (line: string): boolean => {\r\n      return (params.regex && re !== null && line.match(re) !== null)\r\n        || (!params.regex && !params.caseInsensitive && line.includes(params.query))\r\n        || (!params.regex && params.caseInsensitive && (line.toLowerCase().includes(params.query.toLowerCase()) || line.toUpperCase().includes(params.query.toUpperCase())));\r\n    }\r\n\r\n    const processingPromisesIndividual: Promise<[string, number[], string[]]>[] = []; // for progress bar\r\n    const processingPromises: Promise<[string, string, string[], string[][]]>[] = loadingPromises.map(([collectionKey, fileKey, filePromises]) => {\r\n      // Check selected languages for lines that satisfy the query\r\n      const processingFilePromises = filePromises.map((promise) => promise.then(([languageKey, data]) => {\r\n        const lines = data.split(/\\r\\n|\\n/);\r\n        const lineKeys: number[] = [];\r\n        if (params.languages.includes(languageKey)) {\r\n          lines.forEach((line, i) => {\r\n            if (matchCondition(line)) {\r\n              lineKeys.push(i);\r\n            }\r\n          });\r\n        }\r\n        return [languageKey, lineKeys, lines] as [string, number[], string[]];\r\n      }));\r\n      processingFilePromises.forEach((promise) => processingPromisesIndividual.push(promise)); // for progress bar\r\n\r\n      // Filter only the lines that matched\r\n      return Promise.all(processingFilePromises).then((processedFiles) => {\r\n        const languageKeys: string[] = [];\r\n        const lineKeysSet: Set<number> = new Set();\r\n        const fileData: string[][] = [];\r\n\r\n        processedFiles.forEach(([languageKey, lineKeys, lines]) => {\r\n          languageKeys.push(languageKey);\r\n          lineKeys.forEach((i) => lineKeysSet.add(i));\r\n          fileData.push(lines);\r\n        });\r\n\r\n        const fileResults: string[][] = [];\r\n        Array.from(lineKeysSet).sort((a, b) => a - b).forEach((i) => fileResults.push(fileData.map((lines) => postprocessString(lines[i] ?? ''))));\r\n        return [collectionKey, fileKey, languageKeys, fileResults];\r\n      });\r\n    });\r\n\r\n\r\n    // Update progress bar as each file is loaded/processed\r\n    let loadedCount = 0;\r\n    let processedCount = 0;\r\n    let collectedCount = 0;\r\n\r\n    loadingPromisesIndividual.forEach((promise) => {\r\n      promise.then(() => {\r\n        loadedCount++;\r\n        updateStatusInProgress('loading', loadedCount/loadingPromisesIndividual.length, processedCount/processingPromisesIndividual.length, collectedCount/processingPromises.length);\r\n        if (!process.env.NODE_ENV || process.env.NODE_ENV === 'development') {\r\n          console.log(`Loaded ${loadedCount}/${loadingPromisesIndividual.length}`);\r\n        }\r\n      });\r\n    })\r\n\r\n    processingPromisesIndividual.forEach((promise) => {\r\n      promise.then(() => {\r\n        processedCount++;\r\n        updateStatusInProgress('processing', loadedCount/loadingPromisesIndividual.length, processedCount/processingPromisesIndividual.length, collectedCount/processingPromises.length);\r\n        if (!process.env.NODE_ENV || process.env.NODE_ENV === 'development') {\r\n          console.log(`Processed ${processedCount}/${processingPromisesIndividual.length}`);\r\n        }\r\n      });\r\n    })\r\n\r\n\r\n    // Collect results\r\n    Promise.all(processingPromises).then((processingResults) => {\r\n      const resultsLanguages: string[][] = [];\r\n      const results: [string, string, string[][]][] = [];\r\n      processingResults.forEach(([collectionKey, fileKey, languageKeys, fileResults], collectedCount) => {\r\n        resultsLanguages.push(languageKeys);\r\n        results.push([collectionKey, fileKey, fileResults]);\r\n        collectedCount++;\r\n        updateStatusInProgress('collecting', loadedCount/loadingPromisesIndividual.length, processedCount/processingPromisesIndividual.length, collectedCount/processingPromises.length);\r\n        if (!process.env.NODE_ENV || process.env.NODE_ENV === 'development') {\r\n          console.log(`Collected ${collectedCount}/${processingPromises.length}`);\r\n        }\r\n      });\r\n      updateStatusComplete('done', resultsLanguages, results);\r\n      self.close();\r\n    })\r\n    .catch((err) => {\r\n      console.error(err);\r\n      updateStatusComplete('error');\r\n      self.close();\r\n    });\r\n  }\r\n  catch (err) {\r\n    console.error(err);\r\n    updateStatusComplete('error');\r\n    self.close();\r\n  }\r\n};\r\n"],"names":["_arrayLikeToArray","arr","len","length","i","arr2","Array","_slicedToArray","isArray","_i","Symbol","iterator","_s","_e","_x","_r","_arr","_n","_d","call","next","Object","done","push","value","err","o","minLen","n","prototype","toString","slice","constructor","name","from","test","TypeError","self","onmessage","message","remap3DSSpecialCharacters","s","search","map","c","codePoint","codePointAt","undefined","join","remapChineseChars","replaceAll","_","initial","syllable","normalize","substring","final","match","split","remapKoreanBraille","preprocessString","remapSwitchSpecialCharacters","remapNDSSpecialCharacters","updateStatusInProgress","status","loadingProgress","processingProgress","collectingProgress","postMessage","complete","progress","resultsLanguages","results","updateStatusComplete","arguments","params","data","caches","keys","then","keyList","Promise","all","filter","key","delete","loadingPromises","loadingPromisesIndividual","corpus","collectionKey","collections","includes","forEach","collection","languages","every","languageKey","files","fileKey","common","script","loadingFilePromises","url","process","concat","open","cache","res","add","fetch","catch","text","getFileFromCache","promise","re","regex","RegExp","query","caseInsensitive","processingPromisesIndividual","processingPromises","_ref","_ref2","processingFilePromises","_ref3","_ref4","lines","lineKeys","line","toLowerCase","toUpperCase","matchCondition","processedFiles","languageKeys","lineKeysSet","Set","fileData","_ref5","_ref6","fileResults","sort","a","b","_lines$i","loadedCount","processedCount","processingResults","_ref7","collectedCount","_ref8","close","console","error"],"sourceRoot":""}