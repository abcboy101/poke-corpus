{"version":3,"file":"static/js/534.a29f1079.chunk.js","mappings":"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","sources":["searchWorker.ts","../webpack/bootstrap","../webpack/runtime/chunk loaded","../webpack/runtime/define property getters","../webpack/runtime/ensure chunk","../webpack/runtime/get javascript chunk filename","../webpack/runtime/get mini-css chunk filename","../webpack/runtime/hasOwnProperty shorthand","../webpack/runtime/publicPath","../webpack/runtime/importScripts chunk loading","../webpack/runtime/startup chunk dependencies","../webpack/startup"],"sourcesContent":["import 'compression-streams-polyfill';\r\n\r\nexport interface SearchParams {\r\n  query: string,\r\n  regex: boolean,\r\n  caseInsensitive: boolean,\r\n  common: boolean,\r\n  script: boolean,\r\n  collections: string[],\r\n  languages: string[]\r\n};\r\n\r\nexport interface SearchTask {\r\n  index: number,\r\n  params: SearchParams,\r\n  collectionKey: string,\r\n  fileKey: string,\r\n  languages: string[]\r\n}\r\n\r\nexport type SearchTaskResultError = 'error' | 'regex' | 'network';\r\nexport type SearchTaskResultDone = 'done';\r\nexport type SearchTaskResultStatus = 'loading' | 'processing' | SearchTaskResultDone | SearchTaskResultError;\r\nexport interface SearchTaskResultLines {\r\n  collection: string,\r\n  file: string,\r\n  languages: string[],\r\n  lines: string[][]\r\n}\r\nexport interface SearchTaskResult {\r\n  index: number,\r\n  status: SearchTaskResultStatus,\r\n  result?: SearchTaskResultLines\r\n}\r\nexport interface SearchTaskResultComplete {\r\n  index: number,\r\n  status: SearchTaskResultDone,\r\n  result: SearchTaskResultLines\r\n}\r\n\r\nexport const cacheVersion = \"v1\";\r\n\r\n/* eslint-disable no-restricted-globals */\r\nself.onmessage = (task: MessageEvent<SearchTask>) => {\r\n  //#region Helper functions\r\n  /**\r\n   * Attempts the following, in order:\r\n   * - Retrieving the file from the cache\r\n   * - Populating the cache with the file\r\n   * - Fetching the file directly\r\n   *\r\n   * Returns a promise of the text of the file.\r\n   */\r\n  const getFileFromCache = (collectionKey: string, languageKey: string, fileKey: string) => {\r\n    const url = process.env.PUBLIC_URL + `/corpus/${collectionKey}/${languageKey}_${fileKey}.txt.gz`;\r\n    return caches.open(cacheVersion)\r\n    .then((cache) => cache.match(url).then(res => res\r\n      ?? cache.add(url).then(() => cache.match(url)).then(res => res\r\n        ?? fetch(url))))\r\n    .catch(() => fetch(url))\r\n    .catch((err) => {\r\n      console.error(err);\r\n      notify('network');\r\n      return null;\r\n    })\r\n    .then((res) => res === null ? '' :\r\n      res.blob().then((blob) => new Response(blob.stream().pipeThrough(new DecompressionStream('gzip'))).text()))\r\n    .then(preprocessString);\r\n  }\r\n\r\n  // SMUSUM Chinese PokÃ©mon names\r\n  const chineseChars = 'è›‹å¦™è›™ç§å­è‰èŠ±å°ç«é¾™æå–·æ°å°¼é¾Ÿå¡å’ªæ°´ç®­ç»¿æ¯›è™«é“ç”²è›¹å·´å¤§è¶ç‹¬è§’å£³é’ˆèœ‚æ³¢æ¯”é¸Ÿæ‹‰è¾¾çƒˆé›€å˜´é˜¿æŸè›‡æ€ªçš®ä¸˜é›·ç©¿å±±é¼ çŽ‹å¤šå…°å¨œåŽæœ—åŠ›è¯ºå¯è¥¿å…­å°¾ä¹èƒ–ä¸è¶…éŸ³è èµ°è·¯è‡­éœ¸æ´¾æ–¯ç‰¹çƒæ‘©é²è›¾åœ°ä¸‰å–µçŒ«è€é¸­å“¥çŒ´æš´è’‚ç‹—é£Žé€ŸèšŠé¦™èŒèšªå›æ³³å£«å‡¯å‹‡åŸºèƒ¡è…•è±ªå–‡å­èŠ½å£å‘†é£ŸçŽ›ç‘™æ¯æ¯’åˆºæ‹³çŸ³éš†å²©é©¬ç„°å…½ç£åˆä¸€è‘±å˜Ÿåˆ©æµ·ç‹®ç™½æ³¥èˆŒè´é¬¼é€šè€¿å‚¬çœ è²˜å¼•æ¢¦äººé’³èŸ¹å·¨éœ¹é›³ç”µé¡½å¼¹æ¤°æ ‘å˜Žå•¦é£žè…¿éƒŽå¿«å¤´ç“¦åŒçŠ€ç‰›é’»å‰è”“è—¤è¢‹å¢¨é‡‘é±¼æ˜Ÿå®é­”å¢™å¶å¤©èž³èž‚è¿·å”‡å§å‡»ç½—è‚¯æ³°é²¤æ™®ç™¾å˜ä¼Šå¸ƒè¾¹èŠåŒ–ç›”é•°åˆ€ç¿¼æ€¥å†»é—ªä½ å“ˆå…‹å¹»å¶æœˆæ¡‚ç«ºè‘µé”¯é³„è“ç«‹å’•å¤œé¹°èŠ­ç“¢å®‰åœ†ä¸è››å‰å­—ç¯ç¬¼å¤ç„¶å’©ç¾ŠèŒ¸ç¾Žä¸½éœ²æ‰çš‡æ¯½æ£‰é•¿æ‰‹å‘æ—¥èœ»èœ“ä¹Œæ²¼å¤ªé˜³äº®é»‘æš—é¸¦å¦–æœªçŸ¥å›¾è…¾æžœç¿éº’éºŸå¥‡æ¦›ä½›æ‰˜åœŸå¼ŸèŽé’¢åƒå£¶èµ«ç‹ƒç†Šåœˆç†”èœ—çŒªçŠç‘šç‚®ç« æ¡¶ä¿¡ä½¿ç¿…æˆ´åŠ è±¡é¡¿â…¡æƒŠé¹¿çŠ¬æ— ç•æˆ˜èˆžå¨ƒå¥¶ç½å¹¸ç¦å…¬ç‚Žå¸å¹¼æ²™ç­æ´›äºšå‡¤æ—¶æœ¨å®ˆå®«æ£®æž—èœ¥èœ´ç¨šé¸¡å£®è·ƒç‹¼çº¹ç›´å†²èŒ§ç‹©çŒŽç›¾ç²‰èŽ²ç«¥å¸½ä¹æ²³æ©¡å®žé¼»ç‹¡çŒ¾å‚²éª¨ç‡•é¸¥èŽ‰å¥ˆæœµæºœç³–é›¨è˜‘è‡æ–—ç¬ æ‡’ç­è¿‡åŠ¨çŒ¿è¯·å‡å±…å¿é¢è€…è„±å¦žå¼çˆ†å¹•ä¸‹æŽŒæœåŒ—ä¼˜é›…å‹¾é­‚çœ¼é‚£æ°å§†è½æ­£æ‹è´Ÿè¤ç”œè”·è–‡æº¶åžç‰™é²¨é²¸é©¼ç…¤ç‚­è·³å™—æ™ƒæ–‘é¢šèšæ¼ ä»™æ­Œé’ç»µä¸ƒå¤•é¼¬æ–©é¥­åŒ™é³…é²¶è™¾å…µèž¯ç§¤å¿µè§¦æ‘‡ç¯®ç¾½ä¸‘çº³é£˜æµ®æ³¡éšæ€¨å½±è¯…å’’å·¡çµå½·å¾¨çƒ­å¸¦é“ƒå‹ƒæ¢­é›ªå†°æŠ¤è±¹çç æ¨±ç©ºæ£˜çˆ±å¿ƒå“‘å±žè‰¾æ¬§ç›–å›ºåç¥ˆä»£å¸Œè‹—å°çŒ›æ›¼æ‹¿å„¿ç‹¸æ³•å¸ˆç®±èŸ€å‹’ä¼¦ç´å«ç¾žè‹žæ§ŒåŸŽç»“è´µå¦‡ç»…èœœå¥³å¸•å…¹æ½œå…”éšå·è€³é­…ä¸œæ–½é“›å“å¦é“œé•œé’Ÿç›†è’å™ªé™†å°–å’¬ä¸è‰¯éª·è§å…‰éœ“è™¹è‡ªèˆ”ç‹‚è¿œï¼ºç”±å¢å¸­æ©éª‘è‰²éœèŽ±è°¢ç±³å°”å®™æä¸»æš–ç‚’æ­¦åˆƒä¸¸å‰‘æŽ¢æ­¥å“¨çº¦æ‰’é…·å†·èš€è±†é¸½é«˜é›‰å¹”åºžæ»šè™èžºé’‰å·®æ¬è¿åŒ ä¿®å»ºèŸ¾èœæŠ•æ‘”æ‰“åŒ…ä¿è¶³èœˆèš£è½¦è½®ç²¾æ ¹è£™é‡Žè›®é²ˆæ··æµæ°“çº¢å€’ç‹’æ®¿æ»‘å·¾å¾å“­å…·æ­»ç¥žæ£ºåŽŸè‚‹å§‹ç¥–ç ´ç°å°˜ç´¢æ²«æ —å¾·å•åµç»†èƒžé€ é¹…å€å››å­£èŒå“Žå‘€è´¥è½»èœ˜åšé½¿ç»„éº»é³—å®‡çƒ›å¹½æ™¶æ–§åšå‡ ä½•æ•æ·åŠŸå¤«çˆ¶èµ¤é©¹åŠˆå¸ä»¤ç‚¸é›„ç§ƒä¸«é¦–æ¶ç‡ƒçƒ§æ¯•äº‘é…‹è¿ªè€¶å¡”èµ›é‡Œç‹å‘±è´ºæŽ˜å½©è““æ´èƒ½éž˜èŠ³èŠ™å¦®å¥½é±¿è´¼è„šé“ åžƒè—»è‡‚æžªä¼žå’šç¢Žé»é’¥æœ½å—ç“œå—¡å“²è£´æ ¼æž­ç‹™å°„ç‚½å’†å“®è™Žæ¼¾å£¬ç¬ƒå•„é“³å°‘å¼ºé”¹å†œèƒœè™»é¬ƒå¼±åé©´ä»”é‡æŒ½æ»´ä¼ªç¡ç½©ç›—ç€ç«¹ç–—çŽ¯æ™ºæŒ¥çŒ©æŽ·èƒ†å™¬å ¡çˆ·å‚æ€§ï¼šé“¶ä¼´é™¨æž•æˆˆè°œæ‹Ÿï¼±ç£¨èˆµé³žæ–ç’žãƒ»é¸£å“žé³ç§‘èŽ«è¿¦è™šå¾è‚Œè´¹æŸè¾‰çº¸å¾¡æœºå¤è›‹å¦™è›™ç¨®å­è‰èŠ±å°ç«é¾æå™´å‚‘å°¼é¾œå¡å’ªæ°´ç®­ç¶ æ¯›èŸ²éµç”²è›¹å·´å¤§è¶ç¨è§’æ®¼é‡èœ‚æ³¢æ¯”é³¥æ‹‰é”çƒˆé›€å˜´é˜¿æŸè›‡æ€ªçš®ä¸˜é›·ç©¿å±±é¼ çŽ‹å¤šè˜­å¨œåŽæœ—åŠ›è«¾å¯è¥¿å…­å°¾ä¹èƒ–ä¸è¶…éŸ³è èµ°è·¯è‡­éœ¸æ´¾æ–¯ç‰¹çƒæ‘©é­¯è›¾åœ°ä¸‰å–µè²“è€é´¨å“¥çŒ´çˆ†è’‚ç‹—é¢¨é€ŸèšŠé¦™èŒèšªå›æ³³å£«å‡±å‹‡åŸºèƒ¡è…•è±ªå–‡å­èŠ½å£å‘†é£Ÿç‘ªç‘™æ¯æ¯’åˆºæ‹³çŸ³éš†å²©é¦¬ç„°ç¸ç£åˆä¸€è”¥å˜Ÿåˆ©æµ·ç…ç™½æ³¥èˆŒè²é¬¼é€šè€¿å‚¬çœ è²˜å¼•å¤¢äººé‰—èŸ¹å·¨éœ¹é‚é›»é ‘å½ˆæ¤°æ¨¹å˜Žå•¦é£›è…¿éƒŽå¿«é ­ç“¦é›™çŠ€ç‰›é‘½å‰è”“è—¤è¢‹å¢¨é‡‘é­šæ˜Ÿå¯¶é­”ç‰†å¶å¤©èž³èž‚è¿·å”‡å§æ“Šç¾…è‚¯æ³°é¯‰æš´æ™®ç™¾è®Šä¼Šå¸ƒé‚ŠèŠåŒ–ç›”é®åˆ€ç¿¼æ€¥å‡é–ƒä½ å“ˆå…‹å¹»è‘‰æœˆæ¡‚ç«ºè‘µé‹¸é±·è—ç«‹å’•å¤œé·¹èŠ­ç“¢å®‰åœ“çµ²è››å‰å­—ç‡ˆç± å¤ç„¶å’©ç¾ŠèŒ¸ç¾Žéº—éœ²æ‰çš‡æ¯½æ£‰é•·æ‰‹å‘æ—¥èœ»èœ“çƒæ²¼å¤ªé™½äº®é»‘æš—é´‰å¦–æœªçŸ¥åœ–é¨°æžœç¿éº’éºŸå¥‡æ¦›ä½›æ‰˜åœŸå¼Ÿè é‹¼åƒå£ºèµ«ç‹ƒç†Šåœˆç†”è¸è±¬çŠç‘šç‚®ç« æ¡¶ä¿¡ä½¿ç¿…æˆ´åŠ è±¡é “â…¡é©šé¹¿çŠ¬ç„¡ç•æˆ°èˆžå¨ƒå¥¶ç½å¹¸ç¦å…¬ç‚Žå¸å¹¼æ²™ç­æ´›äºžé³³æ™‚æœ¨å®ˆå®®æ£®æž—èœ¥èœ´ç¨šé›žå£¯èºç‹¼ç´‹ç›´è¡ç¹­ç‹©çµç›¾ç²‰è“®ç«¥å¸½æ¨‚æ²³æ©¡å¯¦é¼»ç‹¡çŒ¾å‚²éª¨ç‡•é·—èŽ‰å¥ˆæœµæºœç³–é›¨è˜‘è‡æ–—ç¬ æ‡¶çºéŽå‹•çŒ¿è«‹å‡å±…å¿é¢è€…è„«å¦žå¼å¹•ä¸‹æŽŒæœåŒ—å„ªé›…å‹¾é­‚çœ¼é‚£æ°å§†è½æ­£æ‹è² èž¢ç”œè–”è–‡æº¶åžç‰™é¯Šé¯¨é§ç…¤ç‚­è·³å™—æ™ƒæ–‘é¡ŽèŸ»æ¼ ä»™æ­Œé’ç¶¿ä¸ƒå¤•é¼¬æ–¬é£¯åŒ™é°é¯°è¦å…µèž¯ç§¤å¿µè§¸æ–ç±ƒç¾½é†œç´é£„æµ®æ³¡éš±æ€¨å½±è©›å’’å·¡éˆå½·å¾¨ç†±å¸¶éˆ´å‹ƒæ¢­é›ªå†°è­·è±¹çç æ«»ç©ºæ£˜æ„›å¿ƒå•žå±¬è‰¾æ­è“‹å›ºåç¥ˆä»£å¸Œè‹—å°çŒ›æ›¼æ‹¿å…’ç‹¸æ³•å¸«ç®±èŸ€å‹’å€«ç´å«ç¾žè‹žæ§ŒåŸŽçµè²´å©¦ç´³èœœå¥³å¸•èŒ²æ½›å…”éš¨æ²è€³é­…æ±æ–½éºéŸ¿å¦éŠ…é¡é˜ç›†è’å™ªé™¸å°–å’¬ä¸è‰¯éª·å…‰éœ“è™¹è‡ªèˆ”ç‹‚é ï¼ºç”±ç›§å¸­æ©é¨Žè‰²éœèŠè¬ç±³çˆ¾å®™æä¸»æš–ç‚’æ­¦åˆƒä¸¸åŠæŽ¢æ­¥å“¨ç´„æ‰’é…·å†·è•è±†é´¿é«˜é›‰å¹”é¾æ»¾è™èžºé‡˜å·®æ¬é‹åŒ ä¿®å»ºèŸ¾èœæŠ•æ‘”æ‰“åŒ…ä¿è¶³èœˆèš£è»Šè¼ªæ¯¬ç²¾æ ¹è£™é‡Žè »é±¸æ··æµæ°“ç´…å€’ç‹’æ®¿æ»‘å·¾å¾µå“­å…·æ­»ç¥žæ£ºåŽŸè‚‹å§‹ç¥–ç ´ç°å¡µç´¢æ²«æ —å¾·å–®åµç´°èƒžé€ éµå€å››å­£èŒå“Žå‘€æ•—è¼•èœ˜å …é½’çµ„éº»é°»å®‡ç‡­å¹½æ™¶æ–§åšå¹¾ä½•æ•æ·åŠŸå¤«çˆ¶èµ¤é§’åŠˆå¸ä»¤ç‚¸é›„ç¦¿ä¸«é¦–æƒ¡ç‡ƒç‡’ç•¢é›²é…‹è¿ªè€¶å¡”è³½é‡Œç‹å‘±è³€æŽ˜å½©è““æ½”èƒ½éž˜èŠ³èŠ™å¦®å¥½é­·è³Šè…³éŽ§åžƒè—»è‡‚æ§å‚˜å’šç¢Žé»é‘°æœ½å—ç“œå—¡å“²è£´æ ¼æ¢Ÿç‹™å°„ç†¾å’†å“®è™Žæ¼¾å£¬ç¯¤å•„éŠƒå°‘å¼·é¬è¾²å‹è™»é¬ƒå¼±å£žé©¢ä»”é‡æŒ½æ»´å½ç¡ç½©ç›œè‘—ç«¹ç™‚ç’°æ™ºæ®çŒ©æ“²è†½å™¬å ¡çˆºåƒæ€§ï¼šéŠ€ä¼´éš•æž•æˆˆè¬Žæ“¬ï¼±ç£¨èˆµé±—æ–ç’žãƒ»é³´å“žé°­ç§‘èŽ«è¿¦è™›å¾è‚Œè²»æŸè¼ç´™å¾¡æ©Ÿå¤åž’ç£Šç °å¥¥å£˜ç£Šç °ä¸‘å¥§';\r\n  const remapChineseChars = (s: string) => {\r\n    return s.search(/[\\uE800-\\uEE26]/u) === -1 ? s : (\r\n      Array.from(s).map((c) => {\r\n        const codePoint = c.codePointAt(0);\r\n        return (codePoint !== undefined && codePoint >= 0xE800 && codePoint <= 0xEE26) ? chineseChars[codePoint - 0xE800] : c;\r\n      }).join('')\r\n    );\r\n  }\r\n\r\n  // ORAS Korean Braille\r\n  const remapKoreanBraille = (s: string) => {\r\n    return s.search(/[\\u1100-\\u11FF\\uE0C0-\\uE0C7]/u) === -1 ? s : (s\r\n      .replaceAll('\\uE0C0', 'ê·¸ëž˜ì„œ') // geuraeseo\r\n      .replaceAll('\\uE0C1', 'ê·¸ëŸ¬ë‚˜') // geureona\r\n      .replaceAll('\\uE0C2', 'ê·¸ëŸ¬ë©´') // geureomyeon\r\n      .replaceAll('\\uE0C3', 'ê·¸ëŸ¬ë¯€ë¡œ') // geureomeuro\r\n      .replaceAll('\\uE0C4', 'ê·¸ëŸ°ë°') // geureonde\r\n      .replaceAll('\\uE0C5', 'ê·¸') // UNUSED go\r\n      .replaceAll('\\uE0C6', 'ê·¸ë¦¬í•˜ì—¬') // geurihayeo\r\n      .replaceAll('á†¨á…©', 'ê·¸ë¦¬ê³ ') // geurigeo\r\n      .replaceAll('\\uE0C7á„‰', 'á„Š') // ss\r\n      .replaceAll('\\uE0C7á„€', 'á„') // kk\r\n      .replaceAll('\\uE0C7á„ƒ', 'á„„') // tt\r\n      .replaceAll('\\uE0C7á„‡', 'á„ˆ') // pp\r\n      .replaceAll('\\uE0C7á„Œ', 'á„') // jj\r\n      .replaceAll('\\uE0C7', 'á„‰') // unmatched double consonant\r\n      .replaceAll(/([\\u1100-\\u115F])([ì–µì˜¹ìš¸ì˜¥ì—°ìš´ì˜¨ì–¸ì–¼ì—´ì¸ì˜ì„ì€])/gu, (_, initial: string, syllable: string) => initial + syllable.normalize(\"NFD\").substring(1)) // combine initial with abbreviations\r\n      .replaceAll(/([ê°€ë‚˜ë‹¤ë§ˆë°”ì‚¬ìžì¹´íƒ€íŒŒí•˜])([\\u11A8-\\u11FF])/gu, (_, syllable: string, final: string) => syllable.normalize(\"NFD\") + final) // combine abbreviations with final\r\n      .replaceAll(/^[\\u1160-\\u1175]+$/gum, (match) => '\\u115F' + match.split('').join('\\u115F')) // filler for unmatched vowels in strings of unmatched vowels\r\n      .replaceAll(/(?<![\\u1100-\\u115F])([\\u1160-\\u1175])/gu, 'á„‹$1') // add null initial to all other unmatched vowels\r\n      .replaceAll(/([\\u1100-\\u115F])(?![\\u1160-\\u1175]|$)/gum, '$1\\u1160') // filler for unmatched initials\r\n      .replaceAll(/(?<![\\u1160-\\u1175])([\\u11A8-\\u11FF])/gum, '\\u115F\\u1160$1') // filler for unmatched finals\r\n      .normalize()\r\n    );\r\n  }\r\n\r\n  // NDS special characters\r\n  const remapNDSSpecialCharacters = (s: string) => {\r\n    return s.search(/[\\u2460-\\u2487]/u) === -1 ? s : (s\r\n      .replaceAll('\\u2469', 'áµ‰Ê³') // Gen 5 superscript er\r\n      .replaceAll('\\u246A', 'Ê³áµ‰') // Gen 5 superscript re\r\n      .replaceAll('\\u246B', 'Ê³') // Gen 5 superscript r\r\n      .replaceAll('\\u2485', 'áµ‰') // Gen 5 superscript e\r\n    );\r\n  }\r\n\r\n  // 3DS special characters\r\n  const remap3DSSpecialCharacters = (s: string) => {\r\n    return remapChineseChars(remapKoreanBraille(\r\n      s.search(/[\\uE000-\\uE0A8]/u) === -1 ? s : (s\r\n        // System\r\n        .replaceAll('\\uE000', 'â’¶') // A Button\r\n        .replaceAll('\\uE001', 'â’·') // B Button\r\n        .replaceAll('\\uE002', 'â“') // X Button\r\n        .replaceAll('\\uE003', 'â“Ž') // Y Button\r\n        .replaceAll('\\uE004', 'â“') // L Button\r\n        .replaceAll('\\uE005', 'â“‡') // R Button\r\n        .replaceAll('\\uE006', 'âœœ') // Control Pad\r\n        .replaceAll('\\uE073', 'ðŸ ï¸Ž') // Home Button\r\n\r\n        // PokÃ©mon private use\r\n        .replaceAll('\\uE08A', 'áµ‰Ê³') // Superscript er\r\n        .replaceAll('\\uE08B', 'Ê³áµ‰') // Superscript re\r\n        .replaceAll('\\uE08C', 'Ê³') // Superscript r\r\n        .replaceAll('\\uE092', 'â™¥') // Halfwidth eighth note\r\n        .replaceAll('\\uE09A', 'â™ª') // Halfwidth eighth note\r\n        .replaceAll('\\uE0A6', 'áµ‰') // Superscript e\r\n\r\n        // ORAS Braille\r\n        .replaceAll('\\uE081', '.') // French period (dots-256) [UNUSED]\r\n        .replaceAll('\\uE082', ',') // French comma (dots-2) [UNUSED]\r\n        .replaceAll('\\uE083', '.') // Italian period (dots-256) [UNUSED]\r\n        .replaceAll('\\uE084', ',') // Italian comma (dots-2) [UNUSED]\r\n        .replaceAll('\\uE085', '.') // German period (dots-3)\r\n        .replaceAll('\\uE086', ',') // German comma (dots-2) [UNUSED]\r\n        .replaceAll('\\uE087', '.') // Spanish period (dots-3)\r\n        .replaceAll('\\uE088', ',') // Spanish comma (dots-2) [UNUSED]\r\n      )\r\n    ));\r\n  }\r\n\r\n  // Switch special characters\r\n  const remapSwitchSpecialCharacters = (s: string) => {\r\n    return s.search(/[\\uE300-\\uE31C]/u) === -1 ? s : (s\r\n      .replaceAll('\\uE300', '$') // PokÃ©mon Dollar\r\n      .replaceAll('\\uE301', 'A') // Unown A\r\n      .replaceAll('\\uE302', 'B') // Unown B\r\n      .replaceAll('\\uE303', 'C') // Unown C\r\n      .replaceAll('\\uE304', 'D') // Unown D\r\n      .replaceAll('\\uE305', 'E') // Unown E\r\n      .replaceAll('\\uE306', 'F') // Unown F\r\n      .replaceAll('\\uE307', 'G') // Unown G\r\n      .replaceAll('\\uE308', 'H') // Unown H\r\n      .replaceAll('\\uE309', 'I') // Unown I\r\n      .replaceAll('\\uE30A', 'J') // Unown J\r\n      .replaceAll('\\uE30B', 'K') // Unown K\r\n      .replaceAll('\\uE30C', 'L') // Unown L\r\n      .replaceAll('\\uE30D', 'M') // Unown M\r\n      .replaceAll('\\uE30E', 'N') // Unown N\r\n      .replaceAll('\\uE30F', 'O') // Unown O\r\n      .replaceAll('\\uE310', 'P') // Unown P\r\n      .replaceAll('\\uE311', 'Q') // Unown Q\r\n      .replaceAll('\\uE312', 'R') // Unown R\r\n      .replaceAll('\\uE313', 'S') // Unown S\r\n      .replaceAll('\\uE314', 'T') // Unown T\r\n      .replaceAll('\\uE315', 'U') // Unown U\r\n      .replaceAll('\\uE316', 'V') // Unown V\r\n      .replaceAll('\\uE317', 'W') // Unown W\r\n      .replaceAll('\\uE318', 'X') // Unown X\r\n      .replaceAll('\\uE319', 'Y') // Unown Y\r\n      .replaceAll('\\uE31A', 'Z') // Unown Z\r\n      .replaceAll('\\uE31B', '!') // Unown !\r\n      .replaceAll('\\uE31C', '?') // Unown ?\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Appends additional metadata to each string:\r\n   * - For strings with ruby, appends copies of the strings with the ruby text converted to kana/kanji so that they can be searched.\r\n   *   These copies are separated by `U+F0000` and `U+F0001` so that they can be stripped before display.\r\n   *\r\n   * Returns the resulting string.\r\n   */\r\n  const preprocessMetadata = (s: string) => {\r\n    return s.search(/\\{[^|}]+\\|[^|}]+\\}/u) === -1 ? s : (\r\n      s.replaceAll(/^.*\\{[^|}]+\\|[^|}]+\\}.*$/gum, (line) => {\r\n        const lineKanji = line.replaceAll(/\\{([^|}]+)\\|[^|}]+\\}/gu, '$1');\r\n        const lineKana = line.replaceAll(/\\{[^|}]+\\|([^|}]+)\\}/gu, '$1');\r\n        return [line, '\\u{F0000}', lineKanji, '\\u{F0001}', lineKana].join('');\r\n      })\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Converts private use characters to the corresponding Unicode characters,\r\n   * and adds additional searchable metadata.\r\n   *\r\n   * Returns the resulting string.\r\n   */\r\n  const preprocessString = (s: string) => {\r\n    return preprocessMetadata(remapSwitchSpecialCharacters(remap3DSSpecialCharacters(remapNDSSpecialCharacters(s))));\r\n  }\r\n\r\n  /**\r\n   * Strips additional metadata from each string:\r\n   * - Converted ruby text marked with `U+F0000` and `U+F0001`\r\n   *\r\n   * Returns the resulting string.\r\n   */\r\n  const postprocessMetadata = (s: string) => {\r\n    return s.split('\\u{F0000}')[0];\r\n  }\r\n\r\n  /**\r\n   * Converts the provided string to HTML by escaping `<` and `>`,\r\n   * replacing line break control characters such as  `\\n` with `<br>`,\r\n   * and converting the ruby syntax `{base|ruby}` to the corresponding HTML tags.\r\n   *\r\n   * Returns the resulting HTML string.\r\n   */\r\n  const postprocessString = (s: string) => {\r\n    return (postprocessMetadata(s)\r\n      .replaceAll('<', '&lt;').replaceAll('>', '&gt;')\r\n\r\n      // BDSP\r\n      .replaceAll(/&lt;color=(.*?)&gt;(.*?)&lt;\\/color&gt;/gu, '<span style=\"color: $1\">$2</span>')\r\n      .replaceAll(/&lt;size=(.*?)&gt;(.*?)&lt;\\/size&gt;/gu, '<span style=\"font-size: $1\">$2</span>')\r\n      .replaceAll(/((?<=^|\\\\r|\\\\c|\\\\n).*?)&lt;pos=(.*?)&gt;(.*?(?:\\\\r|\\\\c|\\\\n|$)+)/gu, '<span style=\"tab-size: $2\">$1\\t$3</span>')\r\n      .replaceAll(/((?<=^|\\\\r|\\\\c|\\\\n).*?)&lt;line-indent=(.*?)&gt;(.*?(?:\\\\r|\\\\c|\\\\n|$)+)/gu, '<span style=\"tab-size: $2\">$1\\t$3</span>')\r\n\r\n      .replaceAll('\\u2486', '<sup>P</sup><sub>K</sub>') // Gen 5 PK\r\n      .replaceAll('\\u2487', '<sup>M</sup><sub>N</sub>') // Gen 5 MN\r\n      .replaceAll('\\uE0A7', '<sup>P</sup><sub>K</sub>') // 3DS PK\r\n      .replaceAll('\\uE0A8', '<sup>M</sup><sub>N</sub>') // 3DS MN\r\n      .replaceAll(/\\[VAR FF01\\(FF43\\)\\]\\[VAR FF01\\(30B3\\)\\]/gu, '') // Gen 4 font size\r\n      .replaceAll(/\\[VAR FF01\\(FF43\\)\\](.+?)(?:\\[VAR FF01\\(30B3\\)\\]|\\\\r|\\\\c|\\\\n|$)/gu, '<span class=\"line-font-size-200\"><span class=\"text-font-size-200\">$1</span></span>')\r\n      .replaceAll('[VAR FF01(30B3)]', '')\r\n      .replaceAll(/\\[VAR 0205\\](.*?(?:\\\\r|\\\\c|\\\\n|$)+)/gu, '<span class=\"line-align-center\">$1</span>') // HGSS\r\n      .replaceAll(/\\[VAR 0206\\](.*?(?:\\\\r|\\\\c|\\\\n|$)+)/gu, '<span class=\"line-align-right\">$1</span>') // HGSS\r\n\r\n      // Line breaks\r\n      .replaceAll('[VAR 0207]\\\\n', '<span class=\"c\">&#91;VAR 0207&#93;</span><span class=\"n\">&#92;n</span><br>')\r\n      .replaceAll('[VAR 0208]\\\\n', '<span class=\"r\">&#91;VAR 0208&#93;</span><span class=\"n\">&#92;n</span><br>')\r\n      .replaceAll('\\\\r\\\\n', '<span class=\"r\">&#92;r</span><span class=\"n\">&#92;n</span><br>')\r\n      .replaceAll('\\\\c\\\\n', '<span class=\"c\">&#92;c</span><span class=\"n\">&#92;n</span><br>')\r\n      .replaceAll('[VAR 0207]', '<span class=\"c\">[VAR 0207]</span>')\r\n      .replaceAll('[VAR 0208]', '<span class=\"r\">[VAR 0208]</span>')\r\n      .replaceAll('\\\\r', '<span class=\"r\">&#92;r</span><br>')\r\n      .replaceAll('\\\\c', '<span class=\"c\">&#92;c</span><br>')\r\n      .replaceAll('\\\\n', '<span class=\"n\">&#92;n</span><br>')\r\n\r\n      .replaceAll('\\t', '<span class=\"tab\">\\t</span>')\r\n      .replaceAll('[NULL]', '<span class=\"null\">[NULL]</span>')\r\n      .replaceAll('[COMP]', '<span class=\"compressed\">[COMP]</span>')\r\n      .replaceAll(/(\\[VAR [^\\]]+?\\])/gu, '<span class=\"var\">$1</span>')\r\n      .replaceAll(/(\\[WAIT [\\d.]+\\])/gu, '<span class=\"wait\">$1</span>')\r\n      .replaceAll(/(\\[SFX [\\d.]+\\])/gu, '<span class=\"wait\">$1</span>')\r\n      .replaceAll(/(\\[~ \\d+\\])/gu, '<span class=\"unused\">$1</span>')\r\n      .replaceAll(/\\{([^|}]+)\\|([^|}]+)\\}/gu, '<ruby>$1<rp>(</rp><rt>$2</rt><rp>)</rp></ruby>') // Switch furigana\r\n      .replaceAll(/^(\\s+)$/gu, '<span class=\"whitespace\">$1</span>')\r\n    );\r\n  };\r\n  //#endregion\r\n\r\n  const {index, params, collectionKey, fileKey, languages} = task.data;\r\n  const notify = (status: SearchTaskResultStatus, result?: SearchTaskResultLines) => {\r\n    const message: SearchTaskResult = {\r\n      index: index,\r\n      status: status,\r\n      result: result\r\n    }\r\n    postMessage(message);\r\n  }\r\n\r\n  let re: RegExp | null = null;\r\n  try {\r\n    if (params.regex) {\r\n      re = new RegExp(params.query, params.caseInsensitive ? 'ui' : 'u');\r\n    }\r\n  }\r\n  catch (err) {\r\n    console.error(err);\r\n    notify('regex');\r\n    return;\r\n  }\r\n\r\n  const matchCondition = (line: string): boolean => {\r\n    return (params.regex && re !== null && line.match(re) !== null)\r\n      || (!params.regex && !params.caseInsensitive && line.includes(params.query))\r\n      || (!params.regex && params.caseInsensitive && (line.toLowerCase().includes(params.query.toLowerCase()) || line.toUpperCase().includes(params.query.toUpperCase())));\r\n  };\r\n\r\n  try {\r\n    // Load files\r\n    const filePromises = languages.map((languageKey) => getFileFromCache(collectionKey, languageKey, fileKey).then((data) => [languageKey, data] as [string, string]));\r\n    filePromises.forEach((promise) => promise.then(() => notify('loading')).catch(() => {})); // for progress bar\r\n\r\n    // Process files\r\n    const processingFilePromises = filePromises.map((promise) => promise.then(([languageKey, data]) => {\r\n      const lines = data.split(/\\r\\n|\\n/);\r\n      const lineKeys: number[] = [];\r\n\r\n      // Check selected languages for lines that satisfy the query\r\n      if (params.languages.includes(languageKey)) {\r\n        lines.forEach((line, i) => {\r\n          if (matchCondition(line)) {\r\n            lineKeys.push(i);\r\n          }\r\n        });\r\n      }\r\n      return [languageKey, lineKeys, lines] as [string, number[], string[]];\r\n    }));\r\n    processingFilePromises.forEach((promise) => promise.then(() => notify('processing')).catch(() => {})); // for progress bar\r\n\r\n    // Filter only the lines that matched\r\n    Promise.all(processingFilePromises).then((processedFiles) => {\r\n      const languageKeys: string[] = [];\r\n      const lineKeysSet: Set<number> = new Set();\r\n      const fileData: string[][] = [];\r\n\r\n      processedFiles.forEach(([languageKey, lineKeys, lines]) => {\r\n        languageKeys.push(languageKey);\r\n        lineKeys.forEach((i) => lineKeysSet.add(i));\r\n        fileData.push(lines);\r\n      });\r\n\r\n      const fileResults: string[][] = [];\r\n      Array.from(lineKeysSet).sort((a, b) => a - b).forEach((i) => fileResults.push(fileData.map((lines) => postprocessString(lines[i] ?? ''))));\r\n      notify('done', {\r\n        collection: collectionKey,\r\n        file: fileKey,\r\n        languages: languageKeys,\r\n        lines: fileResults,\r\n      });\r\n    })\r\n    .catch((err) => {\r\n      console.error(err);\r\n      notify('error');\r\n    });\r\n  }\r\n  catch (err) {\r\n    console.error(err);\r\n    notify('error');\r\n  }\r\n};\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n// the startup function\n__webpack_require__.x = function() {\n\t// Load entry module and return exports\n\t// This entry module depends on other loaded chunks and execution need to be delayed\n\tvar __webpack_exports__ = __webpack_require__.O(undefined, [935], function() { return __webpack_require__(534); })\n\t__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n\treturn __webpack_exports__;\n};\n\n","var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = function(chunkId) {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce(function(promises, key) {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks and sibling chunks for the entrypoint\n__webpack_require__.u = function(chunkId) {\n\t// return url for filenames based on template\n\treturn \"static/js/\" + chunkId + \".\" + \"5c991603\" + \".chunk.js\";\n};","// This function allow to reference async chunks and sibling chunks for the entrypoint\n__webpack_require__.miniCssF = function(chunkId) {\n\t// return url for filenames based on template\n\treturn undefined;\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","__webpack_require__.p = \"/poke-corpus/\";","// no baseURI\n\n// object to store loaded chunks\n// \"1\" means \"already loaded\"\nvar installedChunks = {\n\t534: 1\n};\n\n// importScripts chunk loading\nvar installChunk = function(data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\tfor(var moduleId in moreModules) {\n\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t}\n\t}\n\tif(runtime) runtime(__webpack_require__);\n\twhile(chunkIds.length)\n\t\tinstalledChunks[chunkIds.pop()] = 1;\n\tparentChunkLoadingFunction(data);\n};\n__webpack_require__.f.i = function(chunkId, promises) {\n\t// \"1\" is the signal for \"already loaded\"\n\tif(!installedChunks[chunkId]) {\n\t\tif(true) { // all chunks have JS\n\t\t\timportScripts(__webpack_require__.p + __webpack_require__.u(chunkId));\n\t\t}\n\t}\n};\n\nvar chunkLoadingGlobal = self[\"webpackChunkpoke_corpus\"] = self[\"webpackChunkpoke_corpus\"] || [];\nvar parentChunkLoadingFunction = chunkLoadingGlobal.push.bind(chunkLoadingGlobal);\nchunkLoadingGlobal.push = installChunk;\n\n// no HMR\n\n// no HMR manifest","var next = __webpack_require__.x;\n__webpack_require__.x = function() {\n\treturn __webpack_require__.e(935).then(next);\n};","// run startup\nvar __webpack_exports__ = __webpack_require__.x();\n"],"names":["self","onmessage","task","remap3DSSpecialCharacters","s","search","Array","from","map","c","codePoint","codePointAt","undefined","join","remapChineseChars","replaceAll","_","initial","syllable","normalize","substring","final","match","split","remapKoreanBraille","preprocessString","line","lineKanji","lineKana","preprocessMetadata","remapSwitchSpecialCharacters","remapNDSSpecialCharacters","_task$data","data","index","params","collectionKey","fileKey","languages","notify","status","result","postMessage","re","regex","RegExp","query","caseInsensitive","err","console","error","filePromises","languageKey","url","process","concat","caches","open","then","cache","res","add","fetch","catch","blob","Response","stream","pipeThrough","DecompressionStream","text","getFileFromCache","forEach","promise","processingFilePromises","_ref","_ref2","_slicedToArray","lines","lineKeys","includes","i","toLowerCase","toUpperCase","matchCondition","push","Promise","all","processedFiles","languageKeys","lineKeysSet","Set","fileData","_ref3","_ref4","fileResults","sort","a","b","_lines$i","postprocessMetadata","collection","file","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","__webpack_modules__","m","x","__webpack_exports__","O","deferred","chunkIds","fn","priority","notFulfilled","Infinity","length","fulfilled","j","Object","keys","every","key","splice","r","d","definition","o","defineProperty","enumerable","get","f","e","chunkId","reduce","promises","u","miniCssF","obj","prop","prototype","hasOwnProperty","call","p","installedChunks","importScripts","chunkLoadingGlobal","parentChunkLoadingFunction","bind","moreModules","runtime","pop","next"],"sourceRoot":""}